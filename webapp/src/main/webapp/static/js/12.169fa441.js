webpackJsonp([12],{1138:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1139),i=a(1147),n=a(366)(s.a,i.a,null,null,null);t.default=n.exports},1139:function(e,t,a){"use strict";var s=a(1140),i=(a.n(s),a(1141)),n=a(1144),l=a(736),r=a(813),o=a(841),c=!1;t.a={name:"MetadataManagement",components:{TableFilter:i.a,FieldFilter:n.a,BreadCrumb:l.a},data:function(){return{refreshCache:!1,showViewType:0,filter:{keyword:"",type:0},options:[{value:0,label:"库"},{value:1,label:"表"},{value:2,label:"字段"}],table:{isLoading:!1,data:[],total:0,currentPage:1,pageSize:10,pageSizes:[10,20,30,40,50,100]},showAllTable:!1}},beforeRouteEnter:function(e,t,a){c=e.meta.keepAlive,a()},beforeRouteLeave:function(e,t,a){t.meta.keepAlive=!1,a()},activated:function(){!1===c&&(this.showViewType=0,this.filter.keyword="",this.filter.type=0,this.table.data=[],this.table.total=0,this.table.currentPage=1,this.table.pageSize=10,this.init())},mounted:function(){this.init()},methods:{init:function(){this.getMetaList(!0)},getClassName:function(e){return"DELETED"===e.row.status?"delete-status":""},getStyle:function(e){var t=e.row;return this.showAllTable||"DELETED"!==t.status&&!t.virtualTable?"":{display:"none"}},closeAll:function(){var e=this;this.table.data.forEach(function(t){e.$refs.table.toggleRowExpansion(t,!1)})},toCreateView:function(){this.$router.push({path:"/main/metadata/create"})},toDetail:function(e){this.$router.push({path:"/main/metadata/detail/"+e})},handleExpandShow:function(){var e=this;this.$nextTick(function(){if(e.$refs.table){var t=[].slice.call(e.$refs.table.$el.querySelectorAll(".el-table__row"));e.table.data.forEach(function(e,a){e.tableList.length?t[a].querySelector(".el-table__expand-column .cell").style.visibility="visible":t[a].querySelector(".el-table__expand-column .cell").style.visibility="hidden"})}})},refreshData:function(){var e=this;this.refreshCache||(this.refreshCache=!0,o.a().then(function(t){e.handleSearch()}).catch(function(t){e.refreshCache=!1}))},handleSearch:function(){var e=this;switch(this.filter.type){case 0:this.showViewType=0,this.getMetaList(!this.refreshCache,this.refreshCache).then(function(t){e.refreshCache=!1});break;case 1:this.showViewType=1,this.$nextTick(function(){e.$refs["table-filter"].getListByTable(e.filter.keyword,e.refreshCache).then(function(t){e.refreshCache=!1})});break;case 2:this.showViewType=2,this.$nextTick(function(){e.$refs["field-filter"].getListByField(e.filter.keyword,e.refreshCache).then(function(t){e.refreshCache=!1})})}},getMetaList:function(e,t){var a=this;this.table.isLoading=!0,e&&(this.table.currentPage=1);var s=this.filter.keyword;return r.d({query:this.filter.keyword,offset:(this.table.currentPage-1)*this.table.pageSize,limit:this.table.pageSize}).then(function(e){a.filter.keyword===s&&(a.table.isLoading=!1,a.table.total=e.sum,e.lists.forEach(function(e){e.tableList=[]}),a.table.data=e.lists)}).catch(function(e){a.table.isLoading=!1})},showMore:function(e,t){e.loading=!0,r.g({databaseId:e.databaseId,offset:e.offset+10,limit:10}).then(function(t){e.tableList=e.tableList.concat(t.lists),e.offset=t.offset,e.count=t.count,e.sum=t.sum,e.loading=!1})},pageChange:function(e){this.table.currentPage=e,this.getMetaList()},pageSizeChange:function(e){this.table.pageSize=e,this.table.currentPage=1,this.getMetaList()},expandChange:function(e,t){e.tableList&&e.tableList.length||(e.loading=!0,r.g({databaseId:e.databaseId,offset:0,limit:10}).then(function(t){e.tableList=t.lists,e.offset=t.offset,e.count=t.count,e.sum=t.sum,e.loading=!1}))}}}},1140:function(e,t){},1141:function(e,t,a){"use strict";var s=a(1142),i=a(1143),n=a(366)(s.a,i.a,null,null,null);t.a=n.exports},1142:function(e,t,a){"use strict";var s=a(915),i=(a.n(s),a(813));t.a={props:{refreshCache:{type:Boolean,default:!1},showAllTable:{type:Boolean,default:!1}},data:function(){return{searchText:this.searchText,table:{isLoading:!1,data:[],total:0,currentPage:1,pageSize:10,pageSizes:[10,20,30,40,50,100]}}},computed:{allTableVisible:function(){return this.showAllTable}},methods:{getClassName:function(e){return"DELETED"===e.row.status?"delete-status":""},getStyle:function(e){var t=e.row;if(!this.allTableVisible&&("DELETED"===t.status||t.virtualTable))return{display:"none"}},toTableDetail:function(e){this.$router.push({path:"/main/metadata/detail/"+e})},getListByTable:function(e,t){return this.searchText=e,this.getList(!t,t)},getList:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.table.isLoading=!0,e&&(this.table.currentPage=1);var a=this.searchText;return i.e({query:this.searchText,offset:(this.table.currentPage-1)*this.table.pageSize,limit:this.table.pageSize}).then(function(e){t.searchText===a&&(t.table.isLoading=!1,t.table.total=e.sum,t.table.data=e.lists)}).catch(function(e){t.table.isLoading=!1})},pageChange:function(e){this.table.currentPage=e,this.getList()},pageSizeChange:function(e){this.table.pageSize=e,this.table.currentPage=1,this.getList()}}}},1143:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"metadata-management-table-filter-page"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.table.isLoading||e.refreshCache,expression:"table.isLoading || refreshCache"}],staticClass:"relative"},[a("el-table",{ref:"table",attrs:{"row-class-name":e.getClassName,data:e.table.data,"row-style":e.getStyle}},[a("el-table-column",{attrs:{"class-name":"cell-filter-item"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("a",{on:{click:function(a){e.toTableDetail(t.row.tableId)}}},[a("i",{staticClass:"iconfont icon-biaoge icon-item"}),e._v(" "),a("span",{staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.row.tableName))])])]),e._v(" "),a("div",[a("i",{staticClass:"iconfont icon-yuanshuju"}),e._v(" "),a("span",{staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.row.databaseName))]),e._v(" "),a("i",{staticClass:"gs-icon-down",style:{transform:"rotate(-90deg)"}}),e._v(" "),a("i",{staticClass:"iconfont icon-biaoge icon-item"}),e._v(" "),a("span",{staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.row.tableName))])])]}}])})],1),e._v(" "),a("gs-pagination",{directives:[{name:"show",rawName:"v-show",value:e.table.total>0,expression:"table.total>0"}],attrs:{current:e.table.currentPage,total:e.table.total,"page-size":e.table.pageSize,"page-sizes":e.table.pageSizes,layout:"range,total,pagesizes,pager,jumper,jumpbtn"},on:{"page-change":e.pageChange,"page-size-change":e.pageSizeChange}})],1)])},staticRenderFns:[]};t.a=s},1144:function(e,t,a){"use strict";var s=a(1145),i=a(1146),n=a(366)(s.a,i.a,null,null,null);t.a=n.exports},1145:function(e,t,a){"use strict";var s=a(915),i=(a.n(s),a(813));t.a={props:{refreshCache:{type:Boolean,default:!1}},data:function(){return{searchText:null,table:{isLoading:!1,data:[],total:0,currentPage:1,pageSize:10,pageSizes:[10,20,30,40,50,100]}}},mounted:function(){},methods:{getClassName:function(e){return"DELETED"===e.row.status?"delete-status":""},toTableFieldDetail:function(e){this.$router.push({path:"/main/metadata/detail/"+e,query:{module:"field"}})},getListByField:function(e,t){return this.searchText=e,this.getList(!t,t)},getList:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.table.isLoading=!0,e&&(this.table.currentPage=1);var a=this.searchText;return i.b({query:this.searchText,offset:(this.table.currentPage-1)*this.table.pageSize,limit:this.table.pageSize}).then(function(e){t.searchText===a&&(t.table.isLoading=!1,t.table.total=e.sum,t.table.data=e.lists)}).catch(function(e){t.table.isLoading=!1})},pageChange:function(e){this.table.currentPage=e,this.getList()},pageSizeChange:function(e){this.table.pageSize=e,this.table.currentPage=1,this.getList()}}}},1146:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"metadata-management-field-filter-page"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.table.isLoading||e.refreshCache,expression:"table.isLoading || refreshCache"}],staticClass:"relative"},[a("el-table",{ref:"table",attrs:{"row-class-name":e.getClassName,data:e.table.data}},[a("el-table-column",{attrs:{"class-name":"cell-filter-item"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("a",{on:{click:function(a){e.toTableFieldDetail(t.row.tableId)}}},[a("i",{staticClass:"iconfont icon-ziduantubiao"}),e._v(" "),a("span",{staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.row.columnName))])])]),e._v(" "),a("div",[a("i",{staticClass:"iconfont icon-yuanshuju"}),e._v(" "),a("span",{staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.row.databaseName))]),e._v(" "),a("i",{staticClass:"gs-icon-down",style:{transform:"rotate(-90deg)"}}),e._v(" "),a("i",{staticClass:"iconfont icon-biaoge icon-item"}),e._v(" "),a("span",{staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.row.tableName))]),e._v(" "),a("i",{staticClass:"gs-icon-down",style:{transform:"rotate(-90deg)"}}),e._v(" "),a("i",{staticClass:"iconfont icon-ziduantubiao icon-item"}),e._v(" "),a("span",{staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.row.columnName))])])]}}])})],1),e._v(" "),a("gs-pagination",{directives:[{name:"show",rawName:"v-show",value:e.table.total>0,expression:"table.total>0"}],attrs:{current:e.table.currentPage,total:e.table.total,"page-size":e.table.pageSize,"page-sizes":e.table.pageSizes,layout:"range,total,pagesizes,pager,jumper,jumpbtn"},on:{"page-change":e.pageChange,"page-size-change":e.pageSizeChange}})],1)])},staticRenderFns:[]};t.a=s},1147:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"metadata-management-page"},[a("div",{staticClass:"content-header"},[a("bread-crumb",{attrs:{"current-level":"元数据管理"}},[a("div",{staticClass:"bread-crumb-metadata-header",attrs:{slot:"header"},slot:"header"},[e._v("元数据管理\n        "),a("span",[a("a",{on:{click:e.refreshData}},[a("i",{staticClass:"iconfont icon-shuaxin2",class:{"animation-rotate":e.refreshCache}})])])])])],1),e._v(" "),a("div",{staticClass:"content-body"},[a("div",{staticClass:"filter-content"},[a("gs-button",{staticClass:"pull-right expand-all",attrs:{type:"text-primary"},on:{click:e.closeAll}},[e._v("全部收起")]),e._v(" "),a("div",{staticClass:"search-filter"},[a("gs-search",{attrs:{disabled:e.refreshCache,placeholder:"请输入搜索内容..."},on:{search:e.handleSearch},model:{value:e.filter.keyword,callback:function(t){e.$set(e.filter,"keyword",t)},expression:"filter.keyword"}},[a("template",{slot:"prepend"},[a("gs-select",{attrs:{disabled:e.refreshCache},model:{value:e.filter.type,callback:function(t){e.$set(e.filter,"type",t)},expression:"filter.type"}},e._l(e.options,function(e){return a("gs-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],2)],1),e._v(" "),a("div",{staticClass:"filter"},[a("gs-checkbox",{model:{value:e.showAllTable,callback:function(t){e.showAllTable=t},expression:"showAllTable"}},[e._v("显示所有表")])],1)],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.table.isLoading||e.refreshCache,expression:"table.isLoading || refreshCache"},{name:"show",rawName:"v-show",value:0===e.showViewType,expression:"showViewType === 0"}],staticClass:"relative db-list"},[a("el-table",{ref:"table",attrs:{"row-class-name":e.getClassName,data:e.table.data,stripe:""},on:{"expand-change":e.expandChange}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.row.loading,expression:"props.row.loading"}],attrs:{"show-header":!1,"row-class-name":e.getClassName,"row-style":e.getStyle,data:t.row.tableList,stripe:""}},[a("el-table-column",{attrs:{prop:"filename",label:"数据名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"iconfont icon-biaoge icon-item"}),e._v(" "),a("span",{staticClass:"title",on:{click:function(a){e.toDetail(t.row.tableId)}}},[e._v(e._s(t.row.tableName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"描述","class-name":"expand-second-column","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"user",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("gs-button",{attrs:{type:"text-primary"},on:{click:function(a){e.toDetail(t.row.tableId)}}},[e._v("详情")])]}}])})],1),e._v(" "),t.row.tableList.length<t.row.sum?a("div",{staticClass:"text-center show-more"},[a("gs-button",{on:{click:function(a){e.showMore(t.row,t.$index)}}},[e._v("点击加载更多")])],1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"数据名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"iconfont icon-yuanshuju"}),e._v(" "),a("span",{staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.row.databaseName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述",prop:"databaseDescription","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("-")])]}}])})],1),e._v(" "),a("gs-pagination",{directives:[{name:"show",rawName:"v-show",value:e.table.total>0,expression:"table.total>0"}],attrs:{current:e.table.currentPage,total:e.table.total,"page-size":e.table.pageSize,"page-sizes":e.table.pageSizes,layout:"range,total,pagesizes,pager,jumper,jumpbtn"},on:{"page-change":e.pageChange,"page-size-change":e.pageSizeChange}})],1),e._v(" "),a("table-filter",{directives:[{name:"show",rawName:"v-show",value:1===e.showViewType,expression:"showViewType === 1"}],ref:"table-filter",attrs:{"show-all-table":e.showAllTable,"refresh-cache":e.refreshCache}}),e._v(" "),a("field-filter",{directives:[{name:"show",rawName:"v-show",value:2===e.showViewType,expression:"showViewType === 2"}],ref:"field-filter",attrs:{"refresh-cache":e.refreshCache}})],1)])},staticRenderFns:[]};t.a=s},736:function(e,t,a){"use strict";var s=a(737),i=a(740);a.n(i);t.a=s.a},737:function(e,t,a){"use strict";var s=a(738),i=a(739),n=a(366)(s.a,i.a,null,null,null);t.a=n.exports},738:function(e,t,a){"use strict";t.a={name:"BreadCrumb",props:{currentLevel:{type:String,required:!0},upperLevel:{type:String,default:""},backPath:{type:String,default:""}},data:function(){return{}},computed:{isHideNav:function(){return!!this.$router.currentRoute.query.nav}}}},739:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return!e.upperLevel||e.isHideNav?a("div",{staticClass:"content-header-single"},[e._t("header",[e._v("\n    "+e._s(e.currentLevel)+"\n  ")])],2):a("div",{staticClass:"content-header-both"},[a("div",{staticClass:"back-link"},[a("router-link",{attrs:{to:e.backPath}},[a("gs-button",{staticClass:"back-btn",attrs:{type:"primary"}},[a("i",{staticClass:"gs-icon gs-icon-revoke"})])],1)],1),e._v(" "),a("div",{staticClass:"nav-name"},[a("div",{staticClass:"current-nav"},[e._v(e._s(e.currentLevel))]),e._v(" "),a("div",{staticClass:"upper-nav"},[e._v(e._s(e.upperLevel))])])])},staticRenderFns:[]};t.a=s},740:function(e,t){},915:function(e,t){}});
//# sourceMappingURL=12.169fa441.js.map