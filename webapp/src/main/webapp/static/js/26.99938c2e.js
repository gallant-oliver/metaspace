webpackJsonp([26],{2243:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(2244),n=a(2246),s=a(107)(i.a,n.a,null,null,null);e.default=s.exports},2244:function(t,e,a){"use strict";var i=a(161),n=a.n(i),s=a(2245),o=(a.n(s),a(803));e.a={components:{},props:{activeGroup:{type:Object,default:function(){return{}}}},data:function(){return{activeTab:"mine",createApiModalVisible:!1,keyword:"",tableData:[],pagination:{total:0,pageSize:10,pageSizes:[10,20,30],current:1},loading:!1,publishState:"all",selectApi:[]}},watch:{activeGroup:{handler:function(t){t.guid&&this.fetchTableList(1)},deep:!0,immediate:!0}},methods:{batchPublishApi:function(){this.selectApi.length?(localStorage&&localStorage.setItem("SELECTED_API",n()(this.selectApi)),this.$router.push("/main/data-share/publish")):this.$Message.warning("请选择要发布的API")},publish:function(t){localStorage&&localStorage.setItem("SELECTED_API",n()([t.row])),this.$router.push("/main/data-share/publish")},pageChange:function(t){this.pagination.current=t,this.fetchTableList()},sizeChange:function(t){this.pagination.pageSize=t,this.fetchTableList(1)},fetchTableList:function(t){var e=this;t&&(this.pagination.current=t),this.loading=!0,o.getApiList({guid:this.activeGroup.guid,belong:"mine"===this.activeTab?0:1,publishState:this.publishState,offset:(this.pagination.current-1)*this.pagination.pageSize,limit:this.pagination.pageSize,query:this.keyword}).then(function(t){e.pagination.total=t.sum,e.tableData=t.lists,e.loading=!1}).catch(function(t){e.loading=!1})},checkDetail:function(t){this.$router.push({path:"/main/data-share/detail/"+t.row.guid,query:{groupId:this.activeGroup.guid}})},revoke:function(t){var e=this;this.$Modal.confirm({title:"撤销",content:"该API已发布，是否撤销？",onOk:function(){o.unPublishApi({ids:[t.row.guid]}).then(function(t){e.$Message.success("撤销成功"),e.fetchTableList()})}})},copyApi:function(t){this.$router.push({name:"/main/data-share/create",query:{apiId:t.row.guid}})},handleSelectionChange:function(t){this.selectApi=t},customRenderHeader:function(t,e){e.column,e.$index;var a=this.publishState,i=this.handleStateChange;return t("div",[t("span",["状态"]),t("gs-popover",[t("gs-icon",{attrs:{name:"filter",mode:"button",type:"primary"},slot:"reference"}),t("gs-radio-group",{class:"filter-radio-group",attrs:{value:a},on:{change:i.bind(this)}},[t("gs-radio",{attrs:{label:"all"}},["全部"]),t("gs-radio",{attrs:{label:"publish"}},["发布"]),t("gs-radio",{attrs:{label:"unpublish"}},["未发布"])])])])},handleStateChange:function(t){this.publishState=t,this.fetchTableList(1)},createApi:function(){this.$router.push({name:"/main/data-share/create",query:{groupId:this.$route.query.groupId}})},collect:function(t){var e=this;o[t.row.star?"unCollectApi":"collectApi"]({id:t.row.guid}).then(function(t){e.fetchTableList()})},selectable:function(t,e){return!t.publish}}}},2245:function(t,e){},2246:function(t,e,a){"use strict";var i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"api-tablelist"},[a("gs-tabs",{attrs:{type:"content-tab"},on:{"tab-click":function(e){return t.fetchTableList(1)}},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("gs-tab-pane",{attrs:{label:"我的API",name:"mine"}}),t._v(" "),a("gs-tab-pane",{attrs:{label:"全部API",name:"all"}})],1),t._v(" "),a("div",{staticClass:"table"},[a("div",{staticClass:"operation-box"},[a("div",{staticClass:"left"},[a("gs-button",{attrs:{type:"primary"},on:{click:t.createApi}},[t._v("\n          创建API\n        ")]),t._v(" "),"mine"===t.activeTab?a("gs-button",{on:{click:t.batchPublishApi}},[t._v("批量发布API")]):t._e()],1),t._v(" "),a("gs-search",{attrs:{placeholder:"请输入API名称"},on:{search:function(e){return t.fetchTableList(1)},clear:function(e){return t.fetchTableList(1)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,pagination:t.pagination,paging:""},on:{"size-change":t.sizeChange,"page-change":t.pageChange,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{selectable:t.selectable,type:"selection",fixed:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"API名称",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{class:{star:!0,"gs-icon-star-o":!e.row.star,"gs-icon-star":e.row.star},attrs:{title:e.row.star?"取消收藏":"收藏"},on:{click:function(a){return t.collect(e)}}}),t._v(" "),a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"groupName",label:"分组","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"version",label:"版本","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"updater",label:"修改人","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"修改时间","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{"render-header":t.customRenderHeader,"max-width":"100",label:"发布状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("span",{staticClass:"dot",class:{active:e.row.publish}}),t._v(" "),a("span",[t._v(t._s(e.row.publish?"已发布":"未发布"))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"160",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("gs-button",{attrs:{type:"text-primary"},on:{click:function(a){return t.checkDetail(e)}}},[t._v("详情")]),t._v(" "),e.row.publish&&"mine"===t.activeTab?a("gs-button",{attrs:{disabled:"mine"!==t.activeTab,type:"text-primary"},on:{click:function(a){return t.revoke(e)}}},[t._v("撤销")]):t._e(),t._v(" "),e.row.publish||"mine"!==t.activeTab?t._e():a("gs-button",{attrs:{disabled:"mine"!==t.activeTab,type:"text-primary"},on:{click:function(a){return t.publish(e)}}},[t._v("发布")]),t._v(" "),a("gs-button",{attrs:{type:"text-primary"},on:{click:function(a){return t.copyApi(e)}}},[t._v("克隆")])]}}])})],1),t._v(" "),a("gs-pagination",t._b({attrs:{"page-sizes":[10,20,30],layout:"range,total,pagesizes,pager,jumper,jumpbtn"},on:{"page-change":t.pageChange,"page-size-change":t.sizeChange}},"gs-pagination",t.pagination,!1))],1)],1)},staticRenderFns:[]};e.a=i}});
//# sourceMappingURL=26.99938c2e.js.map