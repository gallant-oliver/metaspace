webpackJsonp([8],{2011:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(2012),i=a(2025),n=a(107)(s.a,i.a,null,null,null);t.default=n.exports},2012:function(e,t,a){"use strict";var s=a(65),i=a.n(s),n=a(772),r=a(2013),o=a(787),l=a(774),c=a(808),d=a(2014),u=a(2017),h=a(2021),f=a(776),g=a(771),p=a(2024),v=(a.n(p),a(781)),b=v.a.metadataManagement,m=!1;t.a={name:"DataManagement",components:{ActionComfirm:o.a,DataTable:l.a,TwoColumnLayout:c.a,AddRelation:d.a,AddOwner:u.a,EditCategory:h.a,BreadCrumb:f.a},mixins:[r.a],data:function(){return{keyword:"",page:1,pageSize:10,selecteds:[],singleDeleting:null,multiDeleting:!1,tag:"",setOwnerVisible:!1}},computed:i()({},Object(n.c)("relation",{currentRelations:"currentRelations",searchRelations:"searchRelations",relationsStatus:"relationsStatus"}),Object(n.c)("cache",{dataRefreshStatus:"dataRefreshStatus"}),Object(n.c)("user",{modules:"modules"}),{tableData:function(){var e=this.currentRelations,t=this.searchRelations,a=this.isSearchMode,s=this.activeCategory,i=[];return i=a?t:e,s.categoryGuid||a?i:{total:0,list:[]}},tableProps:function(){var e=this.tableData;return{total:e.total,data:e.list}},paginationProps:function(){var e=this.tableProps.total||0;return{current:this.page,pageSize:this.pageSize,total:e}},isRelationLoading:function(){return Object(g.d)(this.relationsStatus)},isRefreshing:function(){return Object(g.d)(this.dataRefreshStatus)},canCreateRelation:function(){var e=this.activeCategory.privilege;return(void 0===e?{}:e).createRelation},canDeleteRelation:function(){var e=this.activeCategory.privilege;return(void 0===e?{}:e).deleteRelation},canAddOwner:function(){var e=this.modules,t=v.a.editTechInfo;return e.modules&&e.modules.some(function(e){return e.moduleId===t})}}),watch:{activeCategory:function(e){e&&(this.page=1,this.getCategoryRelation())}},beforeRouteEnter:function(e,t,a){m=e.meta.keepAlive,a()},beforeRouteLeave:function(e,t,a){t.meta.keepAlive=!1,a()},activated:function(){!1===m&&(this.keyword="",this.tag="",this.isSearchMode=!1,this.activeCategory={},this.getTopLevelCategory())},mounted:function(){this.getTopLevelCategory()},methods:i()({},Object(n.b)("relation",["getRelations","deleteRelation","findRelations"]),Object(n.b)("cache",["refreshDataCache"]),{setActive:function(e){var t=this.activeCategory;t&&t.categoryGuid||e&&e.categoryGuid&&(this.activeCategory=e)},refreshCache:function(){var e=this;this.refreshDataCache().then(function(){e.$Message.success("刷新缓存成功"),e.query()})},afterDeleteCategory:function(e,t){var a=this,s=t.$node.parent,i=s?s.data.children:this.categories.list,n=i.findIndex(function(t){return t.categoryGuid===e});i.splice(n,1),this.activeCategory.categoryGuid===e&&(this.activeCategory={}),setTimeout(function(){a.query()},500)},toCntAnalysis:function(){this.$router.push({path:"/main/data/analysis"})},getCategoryRelation:function(){var e=this.activeCategory;if(e.categoryGuid)return this.getRelations({categoryGuid:e.categoryGuid,param:{offset:(this.page-1)*this.pageSize,limit:this.pageSize}})},query:function(){this.isSearchMode?this.findRelations({filterTableName:this.keyword,tag:this.tag,param:{offset:(this.page-1)*this.pageSize,limit:this.pageSize}}):this.getCategoryRelation()},handlePageChange:function(e){this.page=e,this.query()},handlePageSizeChange:function(e){this.page=1,this.pageSize=e,this.query()},handleSearch:function(e){this.page=1,this.keyword=e,this.isSearchMode=!!e,this.query()},searchTable:function(){var e=this.keyword,t=this.tag;this.page=1,this.isSearchMode=!!e||!!t,this.query()},handleSelectionChange:function(e){this.selecteds=e},clearSelect:function(){this.selecteds=[],this.$refs.relationTable.clearSelection()},handleDeleteRelation:function(e){var t=this,a=this.selecteds,s=(e?e.categoryGuid:null)||this.activeCategory.categoryGuid;if(e){if(this.singleDeleting===e)return;a=[e]}var i=a.map(function(e){return{relationshipGuid:e.relationshipGuid}}),n=function(){t.singleDeleting=null,t.multiDeleting=!1};0!==i.length?(e?this.singleDeleting=e:this.multiDeleting=!0,this.deleteRelation({relations:i,categoryGuid:s}).then(function(){n(),t.selecteds=[],t.$Message.success("取消关联成功"),t.query()},n)):this.$Message.warning("请选择要取消关联的表")},jump2table:function(e){var t=this.modules;t.modules&&t.modules.some(function(e){return e.moduleId===b})?this.$router.push({path:"/main/metadata/detail/"+e.tableGuid,query:{from:"technical"}}):this.$Message.warning("暂无查看表详情的权限，请找管理员开通")},handleNodeToggle:function(e,t){},showSetOwner:function(){this.selecteds&&this.selecteds.length?this.setOwnerVisible=!0:this.$Message.warning("请选择要配置数据Owner的表")},refreshTable:function(){var e=this;this.refreshDataCache().then(function(){e.query()})},cancelSetOwner:function(){this.setOwnerVisible=!1,this.selecteds=[]}})}},2013:function(e,t,a){"use strict";var s=a(65),i=a.n(s),n=a(772),r=a(815),o=a(771),l=function(e){var t=e.privilege||{};return[{label:"在前添加同级目录",disabled:!t.addSibling,value:0},{label:"在后添加同级目录",disabled:!t.addSibling,value:1},{label:"添加子目录",disabled:!t.addChildren,value:2},{label:"编辑",disabled:!t.edit,value:3},{label:"删除",disabled:!t.delete,value:4}]};t.a={components:{SideTree:r.a},data:function(){return{isSearchMode:!1,visible:!1,actionType:-1,editingCategory:{},actions:l,activeCategory:{},disabled:!0}},computed:i()({},Object(n.c)("category",{categories:"categories"}),Object(n.c)("user",{modules:"modules"}),{isLoadingCategory:function(){return Object(o.d)(this.categories.status)},treeProps:function(){return{data:this.categories.list,expandOnFilterMatch:!0,filterNodeMethod:function(e,t){return!e||t.name.includes(e)},props:{label:"name",value:"categoryGuid"},disabled:!0}}}),watch:{},mounted:function(){},methods:i()({},Object(n.b)("category",["getTopLevelCategory","deleteCategory"]),{handleCategorySearch:function(e){this.$refs.sideTree.$refs.tree.filter(e)},handleSelectCategory:function(e){this.isSearchMode=!1,this.activeCategory=e,this.setOwnerVisible&&(this.selecteds=[]),this.setOwnerVisible=!1},handleNodeAction:function(e,t,a){switch(t){case 0:this.editCategory(t,{guid:e.categoryGuid,direction:"up"});break;case 1:this.editCategory(t,{guid:e.categoryGuid,direction:"down"});break;case 2:this.editCategory(t,{guid:e.categoryGuid,parentCategoryGuid:e.categoryGuid});break;case 3:this.editCategory(t,{name:e.name,description:e.description,guid:e.categoryGuid});break;case 4:this.removeCategory(e,a)}},editCategory:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.actionType=e,this.visible=!0,this.editingCategory=t},removeCategory:function(e,t){var a=this,s=e.name,i=e.categoryGuid;this.$Modal.confirm({title:"确定要删除 "+s+" 目录吗？",onOk:function(){a.deleteCategory(i).then(function(){a.$Message.success("删除成功"),a.afterDeleteCategory&&a.afterDeleteCategory(i,t)})}})}})}},2014:function(e,t,a){"use strict";var s=a(2015),i=a(2016),n=a(107)(s.a,i.a,null,null,null);t.a=n.exports},2015:function(e,t,a){"use strict";var s=a(389),i=a.n(s),n=a(108),r=a.n(n),o=a(792),l=a.n(o),c=a(793),d=a.n(c),u=a(856),h=a(1011),f=a(410);t.a={components:{RecycleScroller:f.a},props:{categoryGuid:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{visible:!1,leftSpan:{span:8,xs:{span:24}},rightSpan:{span:15,offset:1,xs:{span:24,offset:0}},keyword:"",searchType:{current:0,label:0},searchTypes:[{value:0,label:"库"},{value:1,label:"表"}],page:1,pageSize:10,selectedNodes:[],treeData:[],loading:!1,metadatas:{sum:0,lists:[]},tables:{},currentAllRelations:{lists:[]},tableChecked:[],tableMap:{},defaultCheckedKeys:[],indeterminateKeys:[],dbMap:{}}},computed:{isEmpty:function(){return 0===this.searchType.current?0===this.treeData.length:!this.tables.lists||0===this.tables.lists.length},selectedTables:function(){var e=this;return this.selectedNodes.map(function(t){return e.tableMap[t]})},isCreating:function(){return!1}},watch:{visible:function(e){this.keyword="",this.searchType={current:0,label:0},this.selectedNodes=[],e&&(this.page=1,this.metadatas={sum:0,lists:[]},this.tables={},this.treeData=[],this.tableChecked=[],this.defaultCheckedKeys=[],this.dbMap={},this.queryMetadatas())}},create:function(){},methods:{showModal:function(){this.visible=!0},renderTreeNode:function(e,t){t.node;var a=t.data,s="table-tree-node-label",i=!!a.children,n="DELETED"===a.status,r=a.label;return s+=n?" is-deleted":"",e("div",{class:"table-tree-node-content"},[e("span",{attrs:{title:r},class:s+=i?" is-parent":""},[r]),e("span",{class:"status"},[n?" (已删除)":""])])},queryMetadatas:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return d()(l.a.mark(function a(){var s,i,n,r,o,c,d,h,f,g,p,v;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=e.categoryGuid,i=e.keyword,n=e.page,r=e.pageSize,o=e.tables,c=e.metadatas,d=0===e.searchType.current?c.sum:o.sum,!((h=(n-1)*r)>=d&&d>0)){a.next=5;break}return a.abrupt("return");case 5:if(f={categoryGuid:s,param:{query:i,offset:h,limit:r}},e.loading=!0,0!==e.searchType.current){a.next=22;break}return a.next=10,u.a(f);case 10:g=a.sent,e.loading=!1,e.metadatas={lists:[].concat(e.metadatas.lists,g.lists),sum:g.sum},p=g.lists.map(function(e){return{label:e.dbName,value:e.databaseGuid,status:e.databasestatus}}),t&&(e.treeData=[]),e.treeData=[].concat(e.treeData,p),e.treeData=e.treeData.map(function(t){return e.dbMap[t.value]&&(t.children=e.dbMap[t.value]),t}),e.defaultCheckedKeys=e.metadatas.lists.filter(function(e){return 1===e.check}).map(function(e){return e.databaseGuid}),e.preloadIndeterminateTable(g),e.$nextTick(function(t){var a=e.$refs.tree.getCheckedKeys();e.$refs.tree.setCheckedKeys([].concat(a,e.defaultCheckedKeys,e.selectedNodes)),e.defaultCheckedKeys.map(function(t){var a=e.treeData.findIndex(function(e){return e.value===t});e.treeData[a].disabled=!0}),e.treeData.map(function(e){return"DELETED"===e.status&&(e.disabled=!0),e})}),a.next=27;break;case 22:return a.next=24,u.h(f);case 24:v=a.sent,e.tables={lists:e.tables.lists?[].concat(e.tables.lists,v.lists):v.lists,sum:v.sum},v.lists.map(function(t){e.$set(e.tableMap,t.tableId,t)});case 27:e.loading=!1;case 28:case"end":return a.stop()}},a,e)}))()},handleSearch:function(e){this.searchType.current=this.searchType.label,0===this.searchType.current&&(this.tables={}),this.keyword!==e&&(0===this.searchType.current?(this.treeData=[],this.metadatas={lists:[],sum:0}):this.tables={}),this.keyword=e,this.page=1,this.queryMetadatas(!0)},handleScroll:function(e){var t=e.target,a=t.offsetHeight,s=t.scrollTop;t.scrollHeight-a-s<=20&&!this.loading&&(this.page+=1,this.queryMetadatas())},findIndex:function(e){return this.selectedNodes.findIndex(function(t){return t===e})},handleSelectChange:function(e,t,a){var s=this;if(1===e.$node.level)if(t){if(this.defaultCheckedKeys.includes(e.data.value))return;if(a)e.childNodes.filter(function(e){return e.$node.checked}).length===e.data.children.filter(function(e){return e.disabled}).length&&e.data.children.map(function(e){var t=s.findIndex(e.value);-1===t||e.disabled||s.selectedNodes.splice(t,1)});else e.data.children?(e.data.children.map(function(e){!e.disabled&&s.selectedNodes.push(e.value)}),this.selectedNodes=r()(new i.a(this.selectedNodes))):(this.loading=!0,this.getTableFromDB(e.data.value).then(function(t){var a=t.lists.map(function(e){return s.$set(s.tableMap,e.tableId,e),e.check||s.selectedNodes.push(e.tableId),{label:e.tableName,value:e.tableId,leaf:!0,disabled:"DELETED"===e.status||!!e.check,status:e.status}});s.dbMap[e.data.value]=a;var i=s.treeData.findIndex(function(t){return t.value===e.data.value});return s.$set(s.treeData[i],"children",a),s.$nextTick(function(t){var a=s.$refs.tree.getCheckedKeys();s.$refs.tree.setCheckedKeys([].concat(a,s.defaultCheckedKeys,[e.data.value]))}),s.loading=!1,t}))}else e.data.children&&e.data.children.map(function(e){s.spliceSelectNodes(e.value)});else if(2===e.$node.level){if(e.data.disabled)return;t?this.selectedNodes.includes(e.data.value)||this.selectedNodes.push(e.data.value):this.spliceSelectNodes(e.data.value)}},removeTable:function(e){var t=this;this.selectedNodes.length>500&&(this.loading=!0,setTimeout(function(e){t.loading=!1},1e3)),this.$refs.tree&&this.$refs.tree.getCheckedKeys().includes(e.tableId)?(this.$refs.tree.setChecked(e.tableId,!1),this.spliceSelectNodes(e.tableId)):this.spliceSelectNodes(e.tableId)},handleConfirm:function(){var e=this,t=this.selectedTables.map(function(e){return{tableGuid:e.tableId,tableName:e.tableName,dbName:e.databaseName,status:e.status,createTime:e.createTime}});0!==t.length?this.categoryGuid?h.a({params:t,categoryGuid:this.categoryGuid}).then(function(){e.$Message.success("添加关联成功"),e.$emit("create-success"),e.close()}):this.$Message.warning("请选择要关联的目录"):this.$Message.warning("请选择要关联的表")},close:function(){this.visible=!1},lazyLoad:function(e,t){var a=this;this.getTableFromDB(e.data.value).then(function(s){var i=s.lists.map(function(e){return a.$set(a.tableMap,e.tableId,e),{label:e.tableName,value:e.tableId,leaf:!0,disabled:"DELETED"===e.status,status:e.status}});return a.dbMap[e.data.value]=i,t(i),s}).then(function(t){a.setTableCheck(t,e.data.value)})},nodeClick:function(e,t){},chooseTables:function(e){},getTableFromDB:function(e){return u.g({databaseGuid:e,offset:0,limit:-1,categoryGuid:this.categoryGuid})},setTableCheck:function(e,t){var a=this;this.$nextTick(function(s){var i=e.lists.filter(function(e){return 1===e.check}).map(function(e){return e.tableId}),n=a.$refs.tree.getCheckedKeys();a.$refs.tree.setCheckedKeys([].concat(n,a.defaultCheckedKeys,i));var r=a.treeData.findIndex(function(e){return e.value===t});a.treeData[r].children.map(function(e){i.includes(e.value)||"DELETED"===e.status?e.disabled=!0:e.disabled=!1})})},spliceSelectNodes:function(e){var t=this.findIndex(e);-1!==t&&this.selectedNodes.splice(t,1)},preloadIndeterminateTable:function(e){var t=this;e.lists.filter(function(e){return 2===e.check}).map(function(e){u.g({databaseGuid:e.databaseGuid,offset:0,limit:-1,categoryGuid:t.categoryGuid}).then(function(a){var s=a.lists.map(function(e){return t.$set(t.tableMap,e.tableId,e),{label:e.tableName,value:e.tableId,leaf:!0,status:e.status,disabled:"DELETED"===e.status}}),i=t.treeData.findIndex(function(t){return t.value===e.databaseGuid});return t.$set(t.treeData[i],"children",s),t.dbMap[e.databaseGuid]=s,a}).then(function(a){t.setTableCheck(a,e.databaseGuid)})})}}}},2016:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-relation-box"},[a("gs-button",{attrs:{disabled:!e.categoryGuid||e.disabled,type:"primary"},on:{click:e.showModal}},[e._v("添加关联")]),e._v(" "),a("gs-modal",{staticClass:"add-relation-modal",attrs:{width:800,height:360,top:"60px",title:"添加关联表"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("gs-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("gs-col",e._b({staticClass:"relation-col"},"gs-col",e.leftSpan,!1),[a("label",{staticClass:"relation-label"},[e._v("待添加")]),e._v(" "),a("gs-search",{attrs:{value:e.keyword,placeholder:0===e.searchType.label?"请输入数据库":"请输入数据表"},on:{search:e.handleSearch}},[a("template",{slot:"prepend"},[a("gs-select",{model:{value:e.searchType.label,callback:function(t){e.$set(e.searchType,"label",t)},expression:"searchType.label"}},e._l(e.searchTypes,function(e){return a("gs-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],2),e._v(" "),a("div",{staticClass:"database-box",on:{scroll:e.handleScroll}},[e.isEmpty||Object.keys(e.tables).length?e._e():a("gs-infinite-tree",{ref:"tree",attrs:{data:e.treeData,"render-content":e.renderTreeNode,load:e.lazyLoad,height:266,"node-key":"value","show-checkbox":"",lazy:""},on:{"current-change":e.handleSelectChange,scroll:e.handleScroll,"node-click":e.nodeClick}}),e._v(" "),Object.keys(e.tables).length?a("gs-checkbox-group",{staticClass:"checkbox-group",on:{change:function(t){return e.chooseTables()}},model:{value:e.selectedNodes,callback:function(t){e.selectedNodes=t},expression:"selectedNodes"}},e._l(e.tables.lists||[],function(t){return a("gs-checkbox",{key:t.tableId,attrs:{label:t.tableId,disabled:1===t.check}},[e._v(e._s(t.tableName))])}),1):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isEmpty&&!e.loading,expression:"isEmpty && !loading"}],staticClass:"database-empty"},[e._v("\n            暂无数据\n          ")])],1)],1),e._v(" "),a("gs-col",e._b({staticClass:"relation-col"},"gs-col",e.rightSpan,!1),[a("label",{staticClass:"relation-label"},[e._v("已选表 ("+e._s(e.selectedTables.length)+")")]),e._v(" "),a("div",{staticClass:"table-header"},[a("span",{staticClass:"name"},[e._v("数据表")]),e._v(" "),a("span",{staticClass:"parent"},[e._v("所属数据库")]),e._v(" "),a("span",{staticClass:"path"},[e._v("路径")])]),e._v(" "),a("div",{staticClass:"table",staticStyle:{height:"286px"}},[a("RecycleScroller",{staticStyle:{height:"100%"},attrs:{items:e.selectedTables,"item-size":36,"key-field":"tableId"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.item;return t.index,[a("div",[a("span",{staticClass:"name",attrs:{title:s.tableName}},[e._v(e._s(s.tableName))]),e._v(" "),a("span",{staticClass:"parent",attrs:{title:s.databaseName}},[e._v(e._s(s.databaseName))]),e._v(" "),a("span",{staticClass:"path",attrs:{title:s.path}},[e._v(e._s(s.path))]),e._v(" "),a("span",{staticClass:"operation-btn"},[a("gs-icon",{attrs:{name:"close",mode:"button"},on:{click:function(t){return e.removeTable(s)}}})],1)])]}}])})],1)])],1),e._v(" "),a("template",{slot:"footer"},[a("gs-button",{attrs:{loading:e.isCreating,type:"primary"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("gs-button",{attrs:{disabled:e.isCreating},on:{click:e.close}},[e._v("取消")])],1)],2)],1)},staticRenderFns:[]};t.a=s},2017:function(e,t,a){"use strict";var s=a(2019),i=a(2020);var n=function(e){a(2018)},r=a(107)(s.a,i.a,n,"data-v-4434e9fb",null);t.a=r.exports},2018:function(e,t){},2019:function(e,t,a){"use strict";var s=a(389),i=a.n(s),n=a(108),r=a.n(n),o=a(158),l=a.n(o),c=a(65),d=a.n(c),u=a(772),h=a(774);t.a={components:{dataTable:h.a},props:{table:{type:Array,default:function(){return[]}}},data:function(){return{chosenOrga:[],filterKey:"",breadcrumb:[{name:"组织架构",id:window.systemConfigs.FIRST_LEVEL_ORGA}],storeOrgaData:[],searchOffset:0,showSearchTable:!1,loading:!1,activeItem:{name:"组织架构",id:window.systemConfigs.FIRST_LEVEL_ORGA},offset:0,activeLists:[],showLoadMoreBtn:!1,activeSearchLists:[],showSearchLoadMoreBtn:!1,noCheckedIds:[],refreshLoading:!1}},computed:d()({},Object(u.c)("relation",{organizations:"organizations",searchOrganizations:"searchOrganizations"}),{allOrgaInfo:function(){var e={};return function t(a){if(!a||0===a.length)return[];a.forEach(function(a){return e[a.id]=a,t(a.children)})}([].concat(this.storeOrgaData,this.searchOrganizations.lists||[])),e},chosenOrgaItem:function(){var e=this;return this.chosenOrga.map(function(t){return e.allOrgaInfo[t]})}}),mounted:function(){var e=this;this.loading=!0,this.getOrganization({pid:this.breadcrumb[0].id,param:{limit:10,offset:0}}).then(function(t){e.loading=!1,e.storeOrgaData=JSON.parse(l()(e.organizations.lists)),e.activeLists=e.organizations.lists,e.showLoadMoreBtn=e.activeLists.length<e.organizations.sum})},methods:d()({},Object(u.b)("relation",["getOrganization","queryOrganizations","setOwners","getLastestOrga"]),{searchOrga:function(e){var t=this;this.loading=!0,this.searchOffset=this.storeSearchValue===e?this.searchOffset+10:0,this.queryOrganizations({query:e,offset:this.searchOffset,limit:10}).then(function(a){t.loading=!1,t.storeSearchValue===e?t.activeSearchLists=t.activeSearchLists.concat(t.searchOrganizations.lists):t.activeSearchLists=t.searchOrganizations.lists,t.storeSearchValue=e,t.showSearchLoadMoreBtn=t.activeSearchLists.length<t.searchOrganizations.sum;var s=(t.activeSearchLists||[]).filter(function(e){return t.chosenOrga.includes(e.id)});t.$nextTick(function(e){s.forEach(function(e){t.$refs.searchTable.toggleRowSelection(e,!0)})});var i=t.activeSearchLists.map(function(e){return e.id});t.noCheckedIds=t.chosenOrga.filter(function(e){return!i.includes(e)})}),this.showSearchTable=!0},getOrgaInfo:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&(this.activeItem.id!==e.id||s||a?(this.offset=0,!a&&this.breadcrumb.push(e)):this.offset+=10,this.loading=!0,this.getOrganization({pid:e.id,param:{limit:10,offset:this.offset}}).then(function(i){if(t.loading=!1,t.activeLists=t.activeItem.id!==e.id||s||a?t.organizations.lists:[].concat(t.activeLists,t.organizations.lists),t.showLoadMoreBtn=t.activeLists.length<t.organizations.sum,t.activeItem=e,e.id===window.systemConfigs.FIRST_LEVEL_ORGA&&!a){var n=t.storeOrgaData.map(function(e){return e.id});t.organizations.lists.map(function(e){n.includes(e.id)||t.storeOrgaData.push(e)})}!a&&t.setStoreOrgaData(e,t.organizations.lists)}))},breadcrumbClick:function(e,t){this.breadcrumb=this.breadcrumb.slice(0,t+1),this.getOrgaInfo(e,!0)},deleteOrga:function(e,t){var a=this;this.chosenOrga.splice(t,1);var s=(this.activeSearchLists||[]).filter(function(e){return a.chosenOrga.includes(e.id)});this.$refs.searchTable.clearSelection(),s.forEach(function(e){a.$refs.searchTable.toggleRowSelection(e)})},setStoreOrgaData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];var a,s,i,n=(a=this.storeOrgaData,s=e.id,i=null,function e(t){for(var a=0;a<t.length;a++){if(t[a].id===s){i=t[a];break}t[a]&&t[a].children&&e(t[a].children)}}(a),i);if(n)if(n.children){var r,o=n.children.map(function(e){return e.id}),l=t.filter(function(e){return!o.includes(e.id)});(r=n.children).push.apply(r,l)}else this.$set(n,"children",t)},handleSelectionChange:function(e){if(this.showSearchTable){var t=e.map(function(e){return e.id});this.chosenOrga=r()(new i.a([].concat(t,this.noCheckedIds)))}},confirm:function(){var e=this;if(!this.chosenOrga.length)return this.$Message.warning("请选择组织架构"),!1;var t=this.table.map(function(e){return e.tableGuid}),a=this.chosenOrgaItem.map(function(e){return{id:e.id,type:e.type,pkid:e.pkid}});this.setOwners({tables:t,owners:a}).then(function(t){e.$Message.success("设置Owner成功"),e.$emit("cancel"),e.$emit("refreshtb")})},cancel:function(){this.$emit("cancel")},closeTable:function(){this.showSearchTable=!1,this.searchOffset=0,this.storeSearchValue=null,this.showSearchLoadMoreBtn=!1,this.noCheckedIds=[]},refreshOrga:function(){var e=this;this.refreshLoading=!0,this.getLastestOrga().then(function(t){e.refreshLoading=!1,e.$Message.success("刷新组织架构成功"),e.offset=0,e.getOrgaInfo(e.activeItem,!0,!0)})}})}},2020:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-owner"},[a("div",{staticClass:"choose-table"},[a("p",{staticClass:"title"},[e._v("已选数据表")]),e._v(" "),a("div",{staticClass:"content"},[a("el-table",{attrs:{data:e.table||[],"max-height":"220"}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"tableName",label:"数据表名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"path",label:"路径"}})],1)],1)]),e._v(" "),a("div",{staticClass:"choose-owner"},[a("p",{staticClass:"title"},[e._v("选择数据Owner")]),e._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"chosen"},[a("p",[e._v("已选择(已选择"+e._s(e.chosenOrgaItem.length||0)+"项)")]),e._v(" "),a("ul",{staticClass:"chosen-list"},[e._m(0),e._v(" "),e._l(e.chosenOrgaItem,function(t,s){return a("li",{key:t.id},[a("span",{staticClass:"name",attrs:{title:t.name}},[e._v(e._s(t.name))]),e._v(" "),a("span",{staticClass:"path",attrs:{title:t.path}},[e._v(e._s(t.path))]),e._v(" "),a("gs-button",{attrs:{type:"text-primary",icon:"delete"},on:{click:function(a){return e.deleteOrga(t,s)}}})],1)})],2)]),e._v(" "),a("gs-search",{attrs:{placeholder:"请输入组织名称"},on:{search:e.searchOrga,clear:e.closeTable},model:{value:e.filterKey,callback:function(t){e.filterKey=t},expression:"filterKey"}}),e._v(" "),a("div",{staticClass:"breadcrumb"},[a("gs-button",{attrs:{type:"text-primary"},on:{click:e.refreshOrga}},[a("i",{staticClass:"iconfont icon-shuaxin2",class:{"animation-rotate":e.refreshLoading}})]),e._v(" "),a("el-breadcrumb",{directives:[{name:"show",rawName:"v-show",value:!e.showSearchTable,expression:"!showSearchTable"}],attrs:{separator:"/"}},e._l(e.breadcrumb,function(t,s){return a("el-breadcrumb-item",{key:s},[a("span",{staticClass:"name",on:{click:function(a){return e.breadcrumbClick(t,s)}}},[e._v(e._s(t.name))])])}),1)],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"organization"},[a("ul",{directives:[{name:"show",rawName:"v-show",value:!e.showSearchTable,expression:"!showSearchTable"}],staticClass:"organization-list"},[e.activeLists&&e.activeLists.length?[a("gs-checkbox-group",{model:{value:e.chosenOrga,callback:function(t){e.chosenOrga=t},expression:"chosenOrga"}},e._l(e.activeLists||[],function(t){return a("li",{key:t.id,staticClass:"name"},[a("gs-checkbox",{attrs:{label:t.id},model:{value:e.chosenOrga,callback:function(t){e.chosenOrga=t},expression:"chosenOrga"}},[e._v(e._s(""))]),e._v(" "),a("span",{staticClass:"label",attrs:{title:"点击进入下一层级"},on:{click:function(a){return e.getOrgaInfo(t)}}},[a("i",{staticClass:"iconfont icon-zuzhi"}),e._v(e._s(t.name)+"\n                ")])],1)}),0)]:a("li",[e._v("暂无数据")]),e._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:e.showLoadMoreBtn,expression:"showLoadMoreBtn"}],staticClass:"load-more-btn"},[a("gs-button",{attrs:{type:"text-primary"},on:{click:function(t){return e.getOrgaInfo(e.activeItem)}}},[e._v("点击加载更多")])],1)],2),e._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.showSearchTable,expression:"showSearchTable"}],ref:"searchTable",attrs:{data:e.activeSearchLists},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"path",label:"所属组织架构"}})],1),e._v(" "),a("div",{staticClass:"load-more-btn"},[a("gs-button",{directives:[{name:"show",rawName:"v-show",value:e.showSearchLoadMoreBtn,expression:"showSearchLoadMoreBtn"}],attrs:{type:"text-primary"},on:{click:function(t){return e.searchOrga(e.filterKey)}}},[e._v("点击加载更多")])],1)],1)],1)]),e._v(" "),a("p",{staticClass:"mark"},[e._v("注：数据表Owner作为数据管理员，负责审批使用该表数据的申请。")]),e._v(" "),a("div",{staticClass:"operation"},[a("gs-button",{on:{click:e.cancel}},[e._v("取消")]),e._v(" "),a("gs-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("li",{staticClass:"title"},[t("span",{staticClass:"name"},[this._v("名称")]),this._v(" "),t("span",{staticClass:"path"},[this._v("所属组织架构")])])}]};t.a=s},2021:function(e,t,a){"use strict";var s=a(2022),i=a(2023),n=a(107)(s.a,i.a,null,null,null);t.a=n.exports},2022:function(e,t,a){"use strict";var s=a(65),i=a.n(s),n=a(772),r=a(771);t.a={props:{isShow:{type:Boolean,default:!1},type:{type:Number,default:1},category:{type:Object,default:function(){return{}}}},data:function(){return{rules:{name:[{required:!0,max:64,message:"目录名称不能为空且不能大于64个字符"}]},visible:this.isShow,formData:this.category}},computed:i()({},Object(n.c)("category",{createStatus:"categoryCreateStatus",updateStatus:"categoryUpdateStatus"}),{loading:function(){return Object(r.d)(this.createStatus)||Object(r.d)(this.updateStatus)},title:function(){var e="";switch(this.type){case 0:e="在前添加一级目录";break;case 1:e="在后添加一级目录";break;case 2:e="添加子目录";break;case 3:e="编辑目录"}return e}}),watch:{isShow:function(e){this.visible=e},category:function(e){this.formData=e},visible:function(e){e&&this.$refs.form.resetFields(),this.$emit("update:isShow",e)}},methods:i()({},Object(n.b)("category",["createCategory","updateCategory"]),{setVisible:function(e){this.visible=e},handleOk:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a=e.type,s=e.formData,i=void 0,n="添加成功";0!==a&&1!==a&&2!==a||(i=e.createCategory(s)),3===a&&(i=e.updateCategory(s),n="修改成功"),i.then(function(){e.$Message.success(n),e.setVisible(!1)})}})}})}},2023:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("gs-modal",{staticClass:"category-ceate-modal",attrs:{title:e.title},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("gs-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"70px"}},[a("gs-form-item",{attrs:{label:"目录名称",prop:"name"}},[a("gs-input",{attrs:{placeholder:"请输入目录名称，最大长度64个字符"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("gs-form-item",{attrs:{label:"描述",prop:"description"}},[a("gs-textarea",{attrs:{placeholder:"请输入描述信息，最大长度20个字符"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1)],1),e._v(" "),a("template",{slot:"footer"},[a("gs-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleOk}},[e._v("确定")]),e._v(" "),a("gs-button",{attrs:{disabled:e.loading},on:{click:function(t){return e.setVisible(!1)}}},[e._v("取消")])],1)],2)},staticRenderFns:[]};t.a=s},2024:function(e,t){},2025:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-list-page"},[e.setOwnerVisible?e._e():a("div",{staticClass:"search-group"},[a("gs-input",{staticClass:"search-name",attrs:{placeholder:"请输入表的名称"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),e._v(" "),a("gs-input",{staticClass:"search-tag",attrs:{placeholder:"请输入标签的名称"},model:{value:e.tag,callback:function(t){e.tag=t},expression:"tag"}}),e._v(" "),a("gs-button",{attrs:{type:"primary"},on:{click:e.searchTable}},[e._v("搜索")]),e._v(" "),a("div",{staticClass:"clearfix"})],1),e._v(" "),a("div",{staticClass:"content-header"},[a("bread-crumb",{attrs:{"current-level":"技术数据"}})],1),e._v(" "),a("two-column-layout",[a("side-tree",{ref:"sideTree",attrs:{slot:"left",loading:e.isLoadingCategory,active:e.activeCategory,actions:e.actions,"tree-props":e.treeProps},on:{search:e.handleCategorySearch,"node-click":e.handleSelectCategory,"node-action":e.handleNodeAction,"create-category":function(t){return e.editCategory(1)},"set-active":e.setActive,"node-toggle":e.handleNodeToggle},slot:"left"}),e._v(" "),e.setOwnerVisible?e._e():a("template",{slot:"right"},[a("h3",{staticClass:"list-title"},[e._v("\n        "+e._s(e.activeCategory.name)+"\n        "),a("gs-icon",{attrs:{title:e.isRefreshing?"正在刷新缓存...":"刷新缓存",name:e.isRefreshing?"loading":" iconfont icon-shuaxin2",disabled:e.isRefreshing,type:"primary",mode:"button"},on:{click:e.refreshCache}})],1),e._v(" "),a("div",{staticClass:"action-group"},[a("add-relation",{attrs:{"category-guid":e.activeCategory.categoryGuid,disabled:!e.canCreateRelation},on:{"create-success":e.query}}),e._v(" "),!e.isSearchMode&&e.canDeleteRelation?a("action-comfirm",{attrs:{title:"确定批量取消关联吗？取消关联后，可能会造成无法再次关联， 请谨慎操作！如需帮忙，请联系管理员处理。"},on:{comfirm:e.handleDeleteRelation}},[a("gs-button",{staticClass:"muti-cancel",attrs:{slot:"reference",loading:e.multiDeleting,type:"primary"},slot:"reference"},[e._v("批量取消关联")])],1):e._e(),e._v(" "),e.isSearchMode||e.canDeleteRelation?e._e():a("gs-button",{staticClass:"muti-cancel",attrs:{type:"primary",disabled:""}},[e._v("批量取消关联")]),e._v(" "),a("gs-button",{attrs:{disabled:!e.canAddOwner,type:"primary"},on:{click:e.showSetOwner}},[e._v("配置数据Owner")])],1),e._v(" "),a("data-table",{ref:"relationTable",attrs:{loading:e.isRelationLoading,"table-props":e.tableProps,"pagination-props":e.paginationProps},on:{"selection-change":e.handleSelectionChange,"page-change":e.handlePageChange,"page-size-change":e.handlePageSizeChange}},[a("el-table-column",{key:"selection",attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{key:"tableName",attrs:{prop:"tableName",label:"数据表"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{class:{"is-deleted":"DELETED"===t.row.status},attrs:{title:"查看表详情",href:"javascript:void(0);"},on:{click:function(a){return e.jump2table(t.row)}}},[a("gs-icon",{attrs:{name:" iconfont icon-biaoge"}}),e._v(e._s(t.row.tableName)+"\n              "),a("span",{staticClass:"deleted-text"},[e._v(e._s("DELETED"===t.row.status?"(已删除)":""))])],1)]}}],null,!1,3001903536)}),e._v(" "),a("el-table-column",{key:"dbName",attrs:{prop:"dbName",label:"所属数据库"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("gs-icon",{attrs:{name:" iconfont icon-yuanshuju"}}),e._v(e._s(t.row.dbName)+"\n          ")]}}],null,!1,446370913)}),e._v(" "),a("el-table-column",{attrs:{label:"数据owner",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.dataOwner&&t.row.dataOwner.length?[a("gs-table-tags",{staticClass:"table-tag",attrs:{tags:t.row.dataOwner,"show-count":2,"label-key":"name"}},[e._v(e._s(e.tag.name))])]:a("span",[e._v("-")])]}}],null,!1,180049645)}),e._v(" "),a("el-table-column",{key:"path",attrs:{prop:"path",label:"路径"}}),e._v(" "),e.isSearchMode?e._e():a("el-table-column",{key:"op",attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.canDeleteRelation?a("action-comfirm",{attrs:{title:"确定取消关联吗？取消关联后，可能会造成无法再次关联， 请谨慎操作！如需帮忙，请联系管理员处理。"},on:{comfirm:function(a){return e.handleDeleteRelation(t.row)}}},[a("a",{attrs:{slot:"reference"},slot:"reference"},[e._v("\n                "+e._s(e.singleDeleting===t.row?"正在取消...":"取消关联")+"\n              ")])]):a("gs-button",{attrs:{type:"text-primary",disabled:""}},[e._v("取消关联")])]}}],null,!1,2566464390)})],1)],1),e._v(" "),e.setOwnerVisible?a("template",{slot:"right"},[a("add-owner",{attrs:{table:e.selecteds},on:{cancel:e.cancelSetOwner,refreshtb:e.refreshTable}})],1):e._e()],2),e._v(" "),a("edit-category",{attrs:{"is-show":e.visible,type:e.actionType,category:e.editingCategory},on:{"update:isShow":function(t){e.visible=t},"update:is-show":function(t){e.visible=t}}})],1)},staticRenderFns:[]};t.a=s},774:function(e,t,a){"use strict";var s=a(782);t.a=s.a},776:function(e,t,a){"use strict";var s=a(777),i=a(780);a.n(i);t.a=s.a},777:function(e,t,a){"use strict";var s=a(778),i=a(779),n=a(107)(s.a,i.a,null,null,null);t.a=n.exports},778:function(e,t,a){"use strict";t.a={name:"BreadCrumb",props:{currentLevel:{type:String,required:!0},upperLevel:{type:String,default:""},backPath:{type:String,default:""}},data:function(){return{}},computed:{isHideNav:function(){return!!this.$router.currentRoute.query.nav}},methods:{backBtnClick:function(){this.$emit("back")}}}},779:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return!e.upperLevel||e.isHideNav?a("div",{staticClass:"content-header-single"},[e._t("header",[e._v("\n    "+e._s(e.currentLevel)+"\n  ")])],2):a("div",{staticClass:"content-header-both"},[a("div",{staticClass:"back-link"},[a("router-link",{attrs:{to:e.backPath}},[a("gs-button",{staticClass:"back-btn",attrs:{type:"primary"},on:{click:e.backBtnClick}},[a("i",{staticClass:"gs-icon gs-icon-revoke"})])],1)],1),e._v(" "),a("div",{staticClass:"nav-name"},[a("div",{staticClass:"current-nav"},[e._v(e._s(e.currentLevel))]),e._v(" "),a("div",{staticClass:"upper-nav"},[e._v(e._s(e.upperLevel))])])])},staticRenderFns:[]};t.a=s},780:function(e,t){},782:function(e,t,a){"use strict";var s=a(783),i=a(784),n=a(107)(s.a,i.a,null,null,null);t.a=n.exports},783:function(e,t,a){"use strict";t.a={props:{tableProps:{type:Object,default:function(){return{}}},paginationProps:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},methods:{sortChange:function(e){var t=e.column,a=e.prop,s=e.order;this.$emit("sort-change",{column:t,prop:a,order:s})},handleSelectionChange:function(e){this.$emit("selection-change",e)},pageChange:function(e){this.$emit("page-change",e)},pageSizeChange:function(e){this.$emit("page-size-change",e)},clearSelection:function(){this.$refs.dataTable.clearSelection()},getTable:function(){return this.$refs.dataTable},doLayout:function(){this.$refs.dataTable.doLayout()}}}},784:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-list"},[a("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataTable",on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},"el-table",e.tableProps,!1),[e._t("default")],2),e._v(" "),a("gs-pagination",e._b({attrs:{"page-sizes":[10,20,30,40,50,100],layout:e.paginationProps.layout||"range,total,pagesizes,pager,jumper,jumpbtn"},on:{"page-change":e.pageChange,"page-size-change":e.pageSizeChange}},"gs-pagination",e.paginationProps,!1))],1)},staticRenderFns:[]};t.a=s},787:function(e,t,a){"use strict";var s=a(799),i=a(802);a.n(i);t.a=s.a},799:function(e,t,a){"use strict";var s=a(800),i=a(801),n=a(107)(s.a,i.a,null,null,null);t.a=n.exports},800:function(e,t,a){"use strict";t.a={props:{title:{type:String,default:""},popoverProps:{type:Object,default:function(){return{}}}},data:function(){return{visible:!1}},methods:{onComfirm:function(){this.visible=!1,this.$emit("comfirm")},onCancel:function(){this.visible=!1,this.$emit("cancel")}}}},801:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("gs-popover",e._b({ref:"popover",staticClass:"action-comfirm-popover",attrs:{supernatant:"",placement:"top",trigger:"click"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},"gs-popover",e.popoverProps,!1),[a("div",{staticClass:"action-comfirm"},[e._t("default",[a("gs-icon",{staticClass:"action-comfirm-tip-icon",attrs:{name:"exclamation-circle"}}),e._v(e._s(e.title)+"\n    ")])],2),e._v(" "),a("div",{staticClass:"action-comfirm-footer"},[a("gs-button",{attrs:{type:"text-primary"},on:{click:e.onComfirm}},[e._v("确定")]),e._v(" "),a("gs-button",{attrs:{type:"text"},on:{click:e.onCancel}},[e._v("取消")])],1),e._v(" "),e._t("reference",null,{slot:"reference"})],2)},staticRenderFns:[]};t.a=s},802:function(e,t){},808:function(e,t,a){"use strict";var s=a(820),i=a(823);a.n(i);t.a=s.a},815:function(e,t,a){"use strict";var s=a(816),i=a(819);a.n(i);t.a=s.a},816:function(e,t,a){"use strict";var s=a(817),i=a(818),n=a(107)(s.a,i.a,null,null,null);t.a=n.exports},817:function(e,t,a){"use strict";t.a={props:{loading:{type:Boolean,default:!1},searchProps:{type:Object,default:function(){return{}}},treeProps:{type:Object,default:function(){return{}}},keyword:{type:String,default:""},actions:{type:[Array,Function],default:function(){return[]}},active:{type:Object,default:function(){return{}}},hasAction:{type:Boolean,default:!0},defaultExpanded:{type:Boolean,default:!0},defaultExpandedKeys:{type:Array,default:function(){return[]}},preicon:{type:String,default:"iconfont icon-wenjianjia1"},searchPlaceholder:{type:String,default:"请输入目录名称"},emptyBtnText:{type:String,default:"点击添加目录"}},data:function(){return{searchVal:this.keyword,expandedKeys:[]}},computed:{isEmpty:function(){return this.loading||0===this.treeProps.data.length},expand:function(){return this.defaultExpandedKeys&&this.defaultExpandedKeys.length?this.defaultExpandedKeys:this.expandedKeys}},watch:{keyword:function(e){this.searchVal=e},searchVal:function(e){this.$emit("search",e)},treeProps:function(e){e.data&&e.data.length&&this.defaultExpanded&&this.getExpandedKeys(e.data)},expandedKeys:function(e){var t=this.treeProps.data||[];if(e&&e.length){var a=t.filter(function(t){return t.guid===e[0]});if(!a||!a.length)return;if(a[0].privilege&&!a[0].privilege.ash)return void this.$emit("set-active",a[0]);var s=(a[0].children||[]).filter(function(e){return e.privilege&&!e.privilege.ash});if(!s||!s.length)return;this.$emit("set-active",s[0])}else{if(!t||!t.length)return;this.$emit("set-active",t[0])}}},methods:{getExpandedKeys:function(e){this.expandedKeys=function(e,t){var a=[];return function e(s){s.map(function(s){s.privilege&&s.privilege.ash===t&&(a.push(s.guid),s.children&&s.children&&e(s.children))})}(e),a}(e,!0)},renderTreeNode:function(e,t){var a,s=t.node,i=t.data,n=this.actions,r=this.treeProps,o=this.active,l=this.hasAction,c=r.props,d=c.label,u=c.value,h=c.deleting,f=void 0===h?"deleting":h,g="side-tree-node-label";return"function"==typeof n&&(n=n(i)),g+=o[u]===i[u]?" is-active":"",g+=i.disabled?" is-disabled":"",g+=i[f]?" is-deleting":"",e("div",{class:"side-tree-node-content"},[i[f]?e("span",{class:g},[e("gs-icon",{class:"side-tree-node-icon",attrs:{title:"正在删除",name:"loading"}}),i[d]]):e("span",{attrs:{title:i[d]},class:g,on:{click:this.handleClick.bind(this,i)}},[e("i",(a={class:"side-tree-node-icon"},a.class=this.preicon,a)),i[d]]),l?e("gs-dropdown",{class:"side-tree-action",attrs:{trigger:"click"},on:{select:this.handleAction.bind(this,{node:s,data:i})}},[e("gs-icon",{class:"gs-dropdown-link",attrs:{name:"ellipsis",mode:"button"}}),e("gs-dropdown-menu",{attrs:{align:"right"},slot:"dropdown"},[e("gs-dropdown-items",{attrs:{options:n}})])]):null])},handleNodeToggle:function(e,t){this.$emit("node-toggle",e.data,t)},handleClick:function(e){e.disabled||this.$emit("node-click",e)},handleAction:function(e,t){var a=e.node,s=e.data;this.$emit("node-action",s,t,a)},createCategory:function(){this.$emit("create-category")}}}},818:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"side-tree"},[e.isEmpty?e._e():a("gs-search",e._b({ref:"search",attrs:{placeholder:e.searchPlaceholder},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}},"gs-search",e.searchProps,!1)),e._v(" "),e.isEmpty?e._e():a("gs-tree",e._b({ref:"tree",attrs:{"render-content":e.renderTreeNode,"default-expanded-keys":e.expand,"node-key":"guid"},on:{"node-toggle":e.handleNodeToggle}},"gs-tree",e.treeProps,!1)),e._v(" "),!e.loading&&e.isEmpty&&e.hasAction?a("gs-button",{attrs:{disabled:e.treeProps.disabled,type:"primary"},on:{click:e.createCategory}},[e._v(e._s(e.emptyBtnText))]):e._e()],1)},staticRenderFns:[]};t.a=s},819:function(e,t){},820:function(e,t,a){"use strict";var s=a(821),i=a(822),n=a(107)(s.a,i.a,null,null,null);t.a=n.exports},821:function(e,t,a){"use strict";t.a={props:{leftProps:{type:Object,default:function(){return{span:6,xs:{span:24}}}},rightProps:{type:Object,default:function(){return{span:18,xs:{span:24}}}}}}},822:function(e,t,a){"use strict";var s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"two-column-layout"},[t("div",{staticClass:"left-col"},[this._t("left")],2),this._v(" "),t("div",{staticClass:"right-col"},[this._t("right")],2)])},staticRenderFns:[]};t.a=s},823:function(e,t){}});
//# sourceMappingURL=8.d6309d77.js.map