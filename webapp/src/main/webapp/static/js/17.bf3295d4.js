webpackJsonp([17],{2072:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(2073),r=i(2081),n=i(378)(o.a,r.a,null,null,null);t.default=n.exports},2073:function(e,t,i){"use strict";var o=i(2074),r=(i.n(o),i(2075)),n=i(2078),s=i(807);t.a={components:{addRole:r.a,editRole:n.a},data:function(){return{keyword:"",tableData:[],pagination:{total:0,pageSize:10,pageSizes:[10,20,30],current:1},loading:!1,editModalVisible:!1,editRoleInfo:{}}},computed:{},created:function(){this.fetchRoleList(1)},methods:{fetchRoleList:function(){var e=this;1===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)&&(this.pagination.current=1),this.loading=!0,s.k({offset:(this.pagination.current-1)*this.pagination.pageSize,limit:this.pagination.pageSize,query:this.keyword}).then(function(t){t.lists.map(function(e){return e.description=e.description||"-",e.members=e.members||"0",e.privilegeName=e.privilegeName||"-",e.updateTime=e.updateTime||"-",e}),e.tableData=t.lists,e.pagination.total=t.sum||0,e.loading=!1}).catch(function(t){e.loading=!1})},pageChange:function(e){this.pagination.current=e,this.fetchRoleList()},sizeChange:function(e){this.pagination.pageSize=e,this.fetchRoleList(1)},checkDetail:function(e){var t=e.row;t.roleId&&this.$router.push("/main/auth/roleManagement/"+t.roleId)},deleteRole:function(e){var t=this,i=e.row;i.roleId&&this.$Modal.confirm({title:"警告",content:"是否删除该角色？删除后将无法恢复",onOk:function(){s.f(i.roleId).then(function(e){t.$Message.success("删除角色成功"),t.fetchRoleList()})}})},changeRoleStatus:function(e){var t=this,i=e.row;this.$Modal.confirm({title:"警告",content:"确定要"+(0===i.status?"启用":"禁用")+"该角色吗？",onOk:function(){s.d({roleId:i.roleId,status:0===i.status?1:0}).then(function(e){t.$Message.success((0===i.status?"启用":"禁用")+"角色成功"),t.fetchRoleList()})}})},openEditModal:function(e){var t=e.row;this.editRoleInfo=t,this.editModalVisible=!0},closeEditModal:function(){this.editRoleInfo={},this.editModalVisible=!1}}}},2074:function(e,t){},2075:function(e,t,i){"use strict";var o=i(2076),r=i(2077),n=i(378)(o.a,r.a,null,null,null);t.a=n.exports},2076:function(e,t,i){"use strict";var o=i(807);t.a={data:function(){return{visible:!1,form:{roleName:"",description:"",privilegeId:""},privilegesOptions:[],rules:{roleName:[{required:!0,message:"请填写角色名称",trigger:"blur"}],privilegeId:[{required:!0,message:"请选择技术方案",trigger:"change"}]}}},computed:{title:function(){return"新建角色"}},methods:{openAddRoleModal:function(){this.visible=!0},addRole:function(){var e=this;this.$refs.form.validate(function(t){t&&o.b(e.form).then(function(t){e.visible=!1,e.$Message.success("添加成功"),e.$emit("refreshRoleList")}).catch(function(e){})})},visibleChange:function(e){var t=this;e&&(this.$refs.form.clearValidate(),o.j({limit:-1,query:"",offset:0}).then(function(e){t.privilegesOptions=e.lists}))}}}},2077:function(e,t,i){"use strict";var o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("gs-button",{attrs:{type:"primary"},on:{click:e.openAddRoleModal}},[e._v("新建角色")]),e._v(" "),i("gs-modal",{attrs:{title:e.title},on:{"visible-change":e.visibleChange,confirm:e.addRole},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("gs-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[i("gs-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[i("gs-input",{model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),e._v(" "),i("gs-form-item",{attrs:{label:"描述",prop:"description"}},[i("gs-textarea",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),i("gs-form-item",{attrs:{label:"技术方案",prop:"privilegeId"}},[i("gs-select",{staticClass:"doc-select",attrs:{searchable:"","popper-class":"searchable-select"},model:{value:e.form.privilegeId,callback:function(t){e.$set(e.form,"privilegeId",t)},expression:"form.privilegeId"}},e._l(e.privilegesOptions,function(e){return i("gs-option",{key:e.privilegeId,attrs:{label:e.privilegeName,value:e.privilegeId}})}),1)],1)],1)],1)],1)},staticRenderFns:[]};t.a=o},2078:function(e,t,i){"use strict";var o=i(2079),r=i(2080),n=i(378)(o.a,r.a,null,null,null);t.a=n.exports},2079:function(e,t,i){"use strict";var o=i(807);t.a={props:{show:{type:Boolean,default:!1},role:{type:Object,default:function(){return{}}}},data:function(){return{visible:!1,form:{roleName:"",description:""}}},computed:{title:function(){return"编辑角色"}},watch:{show:function(e){this.visible=e}},methods:{editRole:function(){var e=this;this.$refs.form.validate(function(t){t&&o.g({roleId:e.form.roleId,params:{roleId:e.form.roleId,description:e.form.description}}).then(function(t){e.$emit("close"),e.$Message.success("编辑成功"),e.$emit("refreshRoleList")}).catch(function(e){})})},visibleChange:function(e){if(e){this.$refs.form.clearValidate();var t=this.role,i=t.roleName,o=t.description,r=t.roleId;this.form={roleName:i,description:o,roleId:r}}}}}},2080:function(e,t,i){"use strict";var o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gs-modal",{attrs:{title:e.title},on:{"visible-change":e.visibleChange,confirm:e.editRole,cancel:function(t){return e.$emit("close")}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("gs-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("gs-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[i("span",[e._v(e._s(e.form.roleName))])]),e._v(" "),i("gs-form-item",{attrs:{label:"描述",prop:"description"}},[i("gs-textarea",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)],1)},staticRenderFns:[]};t.a=o},2081:function(e,t,i){"use strict";var o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"role-mangement"},[i("div",{staticClass:"search-box"},[i("add-role",{on:{refreshRoleList:e.fetchRoleList}}),e._v(" "),i("gs-search",{attrs:{placeholder:"请输入角色名称"},on:{clear:function(t){return e.fetchRoleList(1)},search:e.fetchRoleList},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),i("gs-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,pagination:e.pagination,paging:""},on:{"size-change":e.sizeChange,"page-change":e.pageChange}},[i("gs-table-column",{attrs:{prop:"roleName",label:"角色名称","show-overflow-tooltip":""}}),e._v(" "),i("gs-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":""}}),e._v(" "),i("gs-table-column",{attrs:{prop:"members",label:"人数"}}),e._v(" "),i("gs-table-column",{attrs:{prop:"privilegeName",label:"权限方案","show-overflow-tooltip":""}}),e._v(" "),i("gs-table-column",{attrs:{prop:"updateTime",label:"更新时间"}}),e._v(" "),i("gs-table-column",{attrs:{label:"操作",width:"160",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("gs-button",{attrs:{type:"text-primary"},on:{click:function(i){return e.checkDetail(t)}}},[e._v("详情")]),e._v(" "),i("gs-button",{attrs:{type:"text-primary"},on:{click:function(i){return e.openEditModal(t)}}},[e._v("编辑")]),e._v(" "),t.row.status?i("gs-button",{attrs:{disabled:!t.row.disable,type:"text-primary"},on:{click:function(i){return e.changeRoleStatus(t)}}},[e._v("禁用")]):e._e(),e._v(" "),t.row.status?e._e():i("gs-button",{attrs:{disabled:!t.row.disable,type:"text-primary"},on:{click:function(i){return e.changeRoleStatus(t)}}},[e._v("启用")]),e._v(" "),i("gs-button",{attrs:{disabled:!t.row.delete,type:"text-primary"},on:{click:function(i){return e.deleteRole(t)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("edit-role",{attrs:{show:e.editModalVisible,role:e.editRoleInfo},on:{refreshRoleList:e.fetchRoleList,close:e.closeEditModal}})],1)},staticRenderFns:[]};t.a=o},807:function(e,t,i){"use strict";t.k=function(e){return o.a.post("/role/roles",e)},t.f=function(e){return o.a.delete("/role/"+e)},t.j=function(e){return o.a.post("/role/privileges",e)},t.b=function(e){return o.a.post("/role",e)},t.g=function(e){var t=e.params,i=e.roleId;return o.a.put("/role/"+i,t)},t.i=function(e,t){return o.a.post("/role/"+e+"/users",t)},t.e=function(e,t){return o.a.delete("/role/"+e+"/user",{data:t})},t.a=function(e,t){return o.a.post("role/"+e+"/user",t)},t.l=function(e){return o.a.get("/role/"+e+"/privileges")},t.c=function(e){var t=e.params,i=e.roleId;return o.a.put("/role/"+i+"/privileges",t)},t.d=function(e){var t=e.roleId,i=e.status;return o.a.put("/role/"+t+"/"+i)},t.h=function(e,t){return o.a.post("/role/users/"+e,t)};var o=i(744)}});
//# sourceMappingURL=17.bf3295d4.js.map