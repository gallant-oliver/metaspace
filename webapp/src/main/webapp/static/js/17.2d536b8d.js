webpackJsonp([17],{2103:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(2104),a=i(2112),n=i(107)(o.a,a.a,null,null,null);t.default=n.exports},2104:function(e,t,i){"use strict";var o=i(2105),a=(i.n(o),i(2106)),n=i(2109),r=i(855),s=i(774);t.a={components:{addRole:a.a,editRole:n.a,dataTable:s.a},data:function(){return{keyword:"",tableData:[],pagination:{total:0,pageSize:10,pageSizes:[10,20,30],current:1},loading:!1,editModalVisible:!1,editRoleInfo:{}}},computed:{},created:function(){this.fetchRoleList(1)},methods:{fetchRoleList:function(){var e=this;1===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)&&(this.pagination.current=1),this.loading=!0,r.i({offset:(this.pagination.current-1)*this.pagination.pageSize,limit:this.pagination.pageSize,query:this.keyword}).then(function(t){t.lists.map(function(e){return e.description=e.description||"-",e.members=e.members||"0",e.privilegeName=e.privilegeName||"-",e.updateTime=e.updateTime||"-",e}),e.tableData=t.lists,e.pagination.total=t.sum||0,e.loading=!1}).catch(function(t){e.loading=!1})},pageChange:function(e){this.pagination.current=e,this.fetchRoleList()},sizeChange:function(e){this.pagination.pageSize=e,this.fetchRoleList(1)},checkDetail:function(e){var t=e.row;t.roleId&&this.$router.push("/main/auth/roleManagement/"+t.roleId)},deleteRole:function(e){var t=this,i=e.row;i.roleId&&this.$Modal.confirm({title:"警告",content:"是否删除该角色？删除后将无法恢复",onOk:function(){r.e(i.roleId).then(function(e){t.$Message.success("删除角色成功"),t.fetchRoleList()})}})},changeRoleStatus:function(e){var t=this,i=e.row;this.$Modal.confirm({title:"警告",content:"确定要"+(0===i.status?"启用":"禁用")+"该角色吗？",onOk:function(){r.c({roleId:i.roleId,status:0===i.status?1:0}).then(function(e){t.$Message.success((0===i.status?"启用":"禁用")+"角色成功"),t.fetchRoleList()})}})},openEditModal:function(e){var t=e.row;this.editRoleInfo=t,this.editModalVisible=!0},closeEditModal:function(){this.editRoleInfo={},this.editModalVisible=!1}}}},2105:function(e,t){},2106:function(e,t,i){"use strict";var o=i(2107),a=i(2108),n=i(107)(o.a,a.a,null,null,null);t.a=n.exports},2107:function(e,t,i){"use strict";var o=i(855);t.a={data:function(){return{visible:!1,form:{roleName:"",description:"",privilegeId:""},privilegesOptions:[],rules:{roleName:[{required:!0,message:"请填写角色名称",trigger:"blur"},{message:"角色名称长度不能超过64个字符",trigger:"blur",min:1,max:64}],description:[{message:"角色描述长度不能超过64个字符",trigger:"blur",min:1,max:64}],privilegeId:[{required:!0,message:"请选择技术方案",trigger:"change"}]}}},computed:{title:function(){return"新建角色"}},methods:{openAddRoleModal:function(){this.visible=!0},addRole:function(){var e=this;this.$refs.form.validate(function(t){t&&o.a(e.form).then(function(t){e.visible=!1,e.$Message.success("添加成功"),e.$emit("refreshRoleList")}).catch(function(e){})})},visibleChange:function(e){var t=this;e&&(this.$refs.form.clearValidate(),o.h({limit:-1,query:"",offset:0}).then(function(e){t.privilegesOptions=e.lists}))}}}},2108:function(e,t,i){"use strict";var o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("gs-button",{attrs:{type:"primary"},on:{click:e.openAddRoleModal}},[e._v("新建角色")]),e._v(" "),i("gs-modal",{attrs:{title:e.title},on:{"visible-change":e.visibleChange,confirm:e.addRole},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("gs-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[i("gs-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[i("gs-input",{model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),e._v(" "),i("gs-form-item",{attrs:{label:"描述",prop:"description"}},[i("gs-textarea",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),i("gs-form-item",{attrs:{label:"技术方案",prop:"privilegeId"}},[i("gs-select",{staticClass:"doc-select",attrs:{searchable:"","popper-class":"searchable-select"},model:{value:e.form.privilegeId,callback:function(t){e.$set(e.form,"privilegeId",t)},expression:"form.privilegeId"}},e._l(e.privilegesOptions,function(e){return i("gs-option",{key:e.privilegeId,attrs:{label:e.privilegeName,value:e.privilegeId}})}),1)],1)],1)],1)],1)},staticRenderFns:[]};t.a=o},2109:function(e,t,i){"use strict";var o=i(2110),a=i(2111),n=i(107)(o.a,a.a,null,null,null);t.a=n.exports},2110:function(e,t,i){"use strict";var o=i(855);t.a={props:{show:{type:Boolean,default:!1},role:{type:Object,default:function(){return{}}}},data:function(){return{visible:!1,form:{roleName:"",description:""}}},computed:{title:function(){return"编辑角色"}},watch:{show:function(e){this.visible=e}},methods:{editRole:function(){var e=this;this.$refs.form.validate(function(t){t&&o.f({roleId:e.form.roleId,params:{roleId:e.form.roleId,description:e.form.description}}).then(function(t){e.$emit("close"),e.$Message.success("编辑成功"),e.$emit("refreshRoleList")}).catch(function(e){})})},visibleChange:function(e){if(e){this.$refs.form.clearValidate();var t=this.role,i=t.roleName,o=t.description,a=t.roleId;this.form={roleName:i,description:o,roleId:a}}}}}},2111:function(e,t,i){"use strict";var o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gs-modal",{attrs:{title:e.title},on:{"visible-change":e.visibleChange,confirm:e.editRole,cancel:function(t){return e.$emit("close")}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("gs-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("gs-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[i("span",[e._v(e._s(e.form.roleName))])]),e._v(" "),i("gs-form-item",{attrs:{label:"描述",prop:"description"}},[i("gs-textarea",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)],1)},staticRenderFns:[]};t.a=o},2112:function(e,t,i){"use strict";var o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"role-mangement"},[i("div",{staticClass:"search-box"},[i("add-role",{on:{refreshRoleList:e.fetchRoleList}}),e._v(" "),i("gs-search",{attrs:{placeholder:"请输入角色名称"},on:{clear:function(t){return e.fetchRoleList(1)},search:e.fetchRoleList},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),i("data-table",{attrs:{loading:e.loading,"table-props":{data:e.tableData},"pagination-props":e.pagination},on:{"page-change":e.pageChange,"page-size-change":e.sizeChange}},[i("el-table-column",{attrs:{prop:"roleName",label:"角色名称","show-overflow-tooltip":""}}),e._v(" "),i("el-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":""}}),e._v(" "),i("el-table-column",{attrs:{prop:"members",label:"人数"}}),e._v(" "),i("el-table-column",{attrs:{prop:"privilegeName",label:"权限方案","show-overflow-tooltip":""}}),e._v(" "),i("el-table-column",{attrs:{prop:"updateTime",label:"更新时间"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("gs-button",{attrs:{type:"text-primary"},on:{click:function(i){return e.checkDetail(t)}}},[e._v("详情")]),e._v(" "),i("gs-button",{attrs:{type:"text-primary"},on:{click:function(i){return e.openEditModal(t)}}},[e._v("编辑")]),e._v(" "),t.row.status?i("gs-button",{attrs:{disabled:!t.row.disable,type:"text-primary"},on:{click:function(i){return e.changeRoleStatus(t)}}},[e._v("禁用")]):e._e(),e._v(" "),t.row.status?e._e():i("gs-button",{attrs:{disabled:!t.row.disable,type:"text-primary"},on:{click:function(i){return e.changeRoleStatus(t)}}},[e._v("启用")]),e._v(" "),i("gs-button",{attrs:{disabled:!t.row.delete,type:"text-primary"},on:{click:function(i){return e.deleteRole(t)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("edit-role",{attrs:{show:e.editModalVisible,role:e.editRoleInfo},on:{refreshRoleList:e.fetchRoleList,close:e.closeEditModal}})],1)},staticRenderFns:[]};t.a=o},774:function(e,t,i){"use strict";var o=i(782);t.a=o.a},782:function(e,t,i){"use strict";var o=i(783),a=i(784),n=i(107)(o.a,a.a,null,null,null);t.a=n.exports},783:function(e,t,i){"use strict";t.a={props:{tableProps:{type:Object,default:function(){return{}}},paginationProps:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},methods:{sortChange:function(e){var t=e.column,i=e.prop,o=e.order;this.$emit("sort-change",{column:t,prop:i,order:o})},handleSelectionChange:function(e){this.$emit("selection-change",e)},pageChange:function(e){this.$emit("page-change",e)},pageSizeChange:function(e){this.$emit("page-size-change",e)},clearSelection:function(){this.$refs.dataTable.clearSelection()},getTable:function(){return this.$refs.dataTable},doLayout:function(){this.$refs.dataTable.doLayout()}}}},784:function(e,t,i){"use strict";var o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"data-list"},[i("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataTable",on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},"el-table",e.tableProps,!1),[e._t("default")],2),e._v(" "),i("gs-pagination",e._b({attrs:{"page-sizes":[10,20,30,40,50,100],layout:e.paginationProps.layout||"range,total,pagesizes,pager,jumper,jumpbtn"},on:{"page-change":e.pageChange,"page-size-change":e.pageSizeChange}},"gs-pagination",e.paginationProps,!1))],1)},staticRenderFns:[]};t.a=o},855:function(e,t,i){"use strict";t.i=function(e){return o.a.post("/role/roles",e)},t.e=function(e){return o.a.delete("/role/"+e)},t.h=function(e){return o.a.post("/role/privileges",e)},t.a=function(e){return o.a.post("/role",e)},t.f=function(e){var t=e.params,i=e.roleId;return o.a.put("/role/"+i,t)},t.g=function(e,t){return o.a.post("/role/"+e+"/users",t)},t.d=function(e,t){return o.a.delete("/role/"+e+"/user",{data:t})},t.j=function(e){return o.a.get("/role/"+e+"/privileges")},t.b=function(e){var t=e.params,i=e.roleId;return o.a.put("/role/"+i+"/privileges",t)},t.c=function(e){var t=e.roleId,i=e.status;return o.a.put("/role/"+t+"/"+i)};var o=i(773)}});
//# sourceMappingURL=17.2d536b8d.js.map