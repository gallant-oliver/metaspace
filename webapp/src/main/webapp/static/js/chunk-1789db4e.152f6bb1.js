(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1789db4e"],{"0290":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return"timestamp"===t.type?e("gs-date-picker",{attrs:{value:t.valueCache,disabled:t.disabled,type:"date-time"},on:{change:t.change}}):"boolean"===t.type?e("gs-radio-group",{attrs:{value:t.valueCache,disabled:t.disabled},on:{change:t.change}},[e("gs-radio",{attrs:{label:!0}}),e("gs-radio",{attrs:{label:!1}})],1):e("gs-input",{staticClass:"fileds-input",attrs:{placeholder:t.isNumber?"请输入数字":"",value:t.valueCache,disabled:t.disabled},on:{input:t.change}})},s=[],n=(e("b1b1"),e("f559"),e("c5f6"),e("c1df")),l=e.n(n),c=e("ed08"),r={name:"FieldsInput",props:{value:{type:[String,Number,Object,Array,Boolean],default:""},disabled:{type:Boolean,default:!1},type:{type:String,default:""}},data:function(){return{numberType:c["b"]}},computed:{isNumber:function(){var t=this;return this.numberType.some(function(a){return t.type.startsWith(a)})},valueCache:function(){return"timestamp"===this.type&&""!==this.value?l()(this.value):this.value}},methods:{change:function(t){var a="";a="timestamp"===this.type?t.valueOf():this.isNumber&&Number.isSafeInteger(parseFloat(t))?parseFloat(t):t,this.$emit("input",a)}}},o=r,u=(e("43f5"),e("2877")),d=Object(u["a"])(o,i,s,!1,null,null,null);a["a"]=d.exports},3154:function(t,a,e){},"36bd":function(t,a,e){"use strict";var i=e("4bf8"),s=e("77f1"),n=e("9def");t.exports=function(t){var a=i(this),e=n(a.length),l=arguments.length,c=s(l>1?arguments[1]:void 0,e),r=l>2?arguments[2]:void 0,o=void 0===r?e:s(r,e);while(o>c)a[c++]=t;return a}},3846:function(t,a,e){e("9e1e")&&"g"!=/./g.flags&&e("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:e("0bfb")})},"43f5":function(t,a,e){"use strict";var i=e("e932"),s=e.n(i);s.a},5300:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"api-detail-page"},[e("div",{staticClass:"content-header"},[e("bread-crumb",{attrs:{"current-level":"API详情","upper-level":"数据分享","back-path":"/main/data-share"}})],1),e("div",{staticClass:"api-detail-body"},[e("gs-loading",{attrs:{"is-show":t.isDetailLoading}}),e("div",{staticClass:"api-base-info"},[e("div",{staticClass:"info-text"},[e("div",{staticClass:"api-name"},[t._v("\n          "+t._s(t.detailData.name||"-")+"\n          "),e("span",{class:{"status-label":!0,"status-published":t.detailData.publish}},[t._v(t._s(t.detailData.publish?"已发布":"未发布"))])]),e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-item-text"},[t._v("\n            创建人："+t._s(t.detailData.keeper||"-")+"\n          ")]),e("div",{staticClass:"info-item-text"},[t._v("\n            创建时间："+t._s(t.detailData.generateTime||"-")+"\n          ")]),e("div",{staticClass:"info-item-text"},[t._v("\n            修改人："+t._s(t.detailData.updater||"-")+"\n          ")]),e("div",{staticClass:"info-item-text"},[t._v("\n            修改时间："+t._s(t.detailData.updateTime||"-")+"\n          ")])])]),e("div",{staticClass:"action-group"},[t.detailData.edit&&!t.detailData.publish?e("gs-button",{attrs:{type:"text-primary"},on:{click:t.publish}},[t._v("\n          发布\n        ")]):t._e(),t.detailData.edit&&t.detailData.publish?e("gs-button",{attrs:{type:"text-primary"},on:{click:t.unPublish}},[t._v("\n          撤销发布\n        ")]):t._e(),e("gs-button",{attrs:{type:"text-primary"},on:{click:t.copyApi}},[t._v("\n          克隆\n        ")]),t.detailData.edit?e("gs-button",{attrs:{disabled:t.detailData.publish,title:t.detailData.publish?"如欲编辑，请先撤销发布该API":"",type:"text-primary"},on:{click:t.editApi}},[t._v("\n          编辑\n        ")]):t._e(),t.detailData.edit?e("gs-button",{attrs:{disabled:t.detailData.publish,title:t.detailData.publish?"如欲删除，请先撤销发布该API":"",type:"text-primary"},on:{click:t.deleteApi}},[t._v("\n          删除\n        ")]):t._e()],1)]),e("div",{staticClass:"api-extract-info"},[e("gs-tabs",{attrs:{type:"content-tab"},model:{value:t.activeTab,callback:function(a){t.activeTab=a},expression:"activeTab"}},[e("gs-tab-pane",{attrs:{label:"API信息",name:"info"}},[e("div",{staticClass:"info-body"},[e("div",{staticClass:"info-body-base"},[e("div",{staticClass:"info-body-base-title"},[t._v("\n                基本信息\n              ")]),e("div",{staticClass:"info-body-base-item"},[e("div",{staticClass:"info-item-left"},[e("div",{staticClass:"info-item-left-text"},[e("span",{staticClass:"info-label"},[t._v("API名称：")]),t._v(t._s(t.detailData.name||"-")+"\n                  ")]),e("div",{staticClass:"info-item-left-text"},[e("span",{staticClass:"info-label"},[t._v("API分组：")]),t._v(t._s(t.detailData.groupName||"-")+"\n                  ")]),e("div",{staticClass:"info-item-left-text"},[e("span",{staticClass:"info-label"},[t._v("版本：")]),t._v(t._s(t.detailData.version||"-")+"\n                  ")]),e("div",{staticClass:"info-item-left-text"},[e("span",{staticClass:"info-label"},[t._v("描述：")]),t._v(t._s(t.detailData.description||"-")+"\n                  ")])]),e("div",{staticClass:"info-item-right"},[e("div",{staticClass:"info-item-right-text"},[e("span",{staticClass:"info-label"},[t._v("协议类型：")]),t._v(t._s(t.detailData.protocol||"-")+"\n                  ")]),e("div",{staticClass:"info-item-right-text"},[e("span",{staticClass:"info-label"},[t._v("请求方式：")]),t._v(t._s(t.detailData.requestMode||"-")+"\n                  ")]),e("div",{staticClass:"info-item-right-text"},[e("span",{staticClass:"info-label"},[t._v("返回类型：")]),t._v(t._s(t.detailData.returnType||"-")+"\n                  ")]),e("div",{staticClass:"info-item-right-text"},[e("span",{staticClass:"info-label"},[t._v("API路径：")]),t._v(t._s(t.detailData.path||"-")+"\n                  ")])])])]),e("div",{staticClass:"info-body-data"},[e("div",{staticClass:"info-body-data-title"},[t._v("\n                数据信息\n              ")]),e("div",{staticClass:"info-body-data-item"},[e("div",{staticClass:"info-item-text"},[t._v("\n                  数据库："+t._s(t.detailData.dbName||"-")+"\n                ")]),e("div",{staticClass:"info-item-text"},[t._v("\n                  数据表："+t._s(t.detailData.tableName?t.detailData.tableDisplayName+"（"+t.detailData.tableName+"）":"-")+"\n                ")]),e("div",{staticClass:"info-item-text"},[t._v("\n                  数据Owner："+t._s(t.dataOwners)+"\n                ")])]),e("div",{staticClass:"info-body-data-table"},[e("el-table",{attrs:{data:t.apiTableData}},[e("el-table-column",{attrs:{type:"index",label:"序号"}}),e("el-table-column",{attrs:{prop:"columnName",label:"名称","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.columnName?e("span",[t._v(t._s(a.row.displayName)+"（"+t._s(a.row.columnName)+"）")]):e("span",[t._v("-")])]}}])}),e("el-table-column",{attrs:{prop:"filter",label:"筛选字段"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n                      "+t._s(a.row.filter?"是":"否")+"\n                    ")]}}])}),e("el-table-column",{attrs:{prop:"fill",label:"必传"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n                      "+t._s(a.row.fill?"是":"否")+"\n                    ")]}}])}),e("el-table-column",{attrs:{prop:"defaultValue",label:"缺省值"}})],1)],1)])])]),e("gs-tab-pane",{attrs:{label:"测试",name:"test"}},[e("div",{staticClass:"info-body"},[e("div",{staticClass:"req-msg"},[e("h5",{staticClass:"title"},[t._v("\n                请求信息\n              ")]),e("div",{staticClass:"request"},[t._l(t.testData,function(a,i){return e("div",{key:i,staticClass:"fields"},[e("gs-checkbox",{staticClass:"name",model:{value:a.check,callback:function(e){t.$set(a,"check",e)},expression:"item.check"}},[e("span",{attrs:{title:a.displayName+"（"+a.columnName+"）"}},[t._v(t._s(a.displayName+"（"+a.columnName+"）"))])]),e("span",{staticClass:"value"},[e("fields-input",{attrs:{type:a.type},model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"item.value"}})],1)],1)}),e("div",{staticClass:"fields"},[e("span",{staticClass:"name"},[t._v("limit")]),e("span",{staticClass:"value"},[e("gs-input-number",{attrs:{precision:0},model:{value:t.limit,callback:function(a){t.limit=a},expression:"limit"}})],1)]),e("div",{staticClass:"fields"},[e("span",{staticClass:"name"},[t._v("offset")]),e("span",{staticClass:"value"},[e("gs-input-number",{attrs:{precision:0},model:{value:t.offset,callback:function(a){t.offset=a},expression:"offset"}})],1)]),e("div",{staticClass:"gap"})],2),e("div",{staticClass:"test-operation"},[e("gs-button",{attrs:{disabled:!t.btnLoading},on:{click:t.stopTest}},[t._v("\n                  停止测试\n                ")]),e("gs-button",{attrs:{loading:t.btnLoading,type:"primary"},on:{click:t.startTest}},[t._v("\n                  开始测试\n                ")])],1)]),e("div",{staticClass:"rep-res"},[e("h5",{staticClass:"title"},[t._v("\n                返回数据\n              ")]),e("div",{staticClass:"response"},[e("gs-tabs",{attrs:{type:"content-tab"},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[e("gs-tab-pane",{attrs:{label:"编码模式",name:"json"}},[e("gs-textarea",{attrs:{value:t.testResStringify,autosize:{minRows:8,maxRows:12},readonly:""}})],1),e("gs-tab-pane",{attrs:{label:"表格模式",name:"table"}},[e("el-table",{attrs:{data:t.testRes}},t._l(t.tableHeader,function(a,i){return e("el-table-column",{key:i,attrs:{label:a,prop:a},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                          "+t._s(e.row[a]+"")+"\n                        ")]}}],null,!0)})}),1)],1)],1)],1)])])])],1)],1)],1)])},s=[],n=(e("6c7b"),e("db72")),l=e("2f62"),c=e("acc6"),r=e("0290"),o=e("d4b2"),u=(e("3154"),e("6853")),d={components:{BreadCrumb:c["a"],fieldsInput:r["a"]},mixins:[u["a"]],data:function(){return{apiId:"",activeTab:"info"}},computed:Object(n["a"])({},Object(l["c"])("datashare",{apiDetail:"apiDetail"}),{detailData:function(){var t=this.apiDetail;return t.data||{}},apiTableData:function(){return this.detailData.fields||[]},dataOwners:function(){var t=this.detailData.dataOwner||[];return t.join("，")||"-"},isDetailLoading:function(){return Object(o["d"])(this.apiDetail.status)}}),mounted:function(){var t=this,a=this.$route.params||{},e=a.id;this.apiId=e,e&&this.getApiDetail(e).then(function(a){t.testData=(t.detailData.fields||[]).filter(function(t){return t.filter}).map(function(t){return{columnName:t.columnName,displayName:t.displayName,value:"",check:!0,type:t.type,fill:t.fill}})})},methods:Object(n["a"])({},Object(l["b"])("datashare",["getApiDetail","delApi","unPublishApi"]),{deleteApi:function(){var t=this;this.$Modal.confirm({title:"提示",content:"确定删除该API吗？",onOk:function(){t.delApi(t.apiId).then(function(a){t.$Message.success("删除成功"),t.$router.push("/main/data-share")})}})},publish:function(){localStorage&&localStorage.setItem("SELECTED_API",JSON.stringify([this.detailData])),this.$router.push("/main/data-share/publish")},unPublish:function(){var t=this;this.$Modal.confirm({title:"提示",content:"确定撤销发布该API吗？",onOk:function(){t.unPublishApi([t.apiId]).then(function(a){t.$Message.success("撤销成功"),t.getApiDetail(t.apiId)})}})},copyApi:function(){this.$router.push({name:"/main/data-share/create",query:{apiId:this.apiId}})},editApi:function(){this.$router.push({name:"/main/data-share/create",query:{apiId:this.apiId,isEdit:!0}})}})},p=d,f=e("2877"),v=Object(f["a"])(p,i,s,!1,null,null,null);a["default"]=v.exports},6853:function(t,a,e){"use strict";e("6762"),e("2fdb"),e("6c7b"),e("ac6a"),e("456d"),e("6b54");var i=e("f63f"),s=e("bc3a"),n=e.n(s),l=e("ed08"),c=Math.random().toString(36).slice(-8);a["a"]={data:function(){return{testData:[],limit:10,offset:0,btnLoading:!1,activeName:"json",testRes:[],numberType:l["b"]}},computed:{tableHeader:function(){var t=this.testRes;return t&&t[0]?Object.keys(t[0]):[]},testResStringify:function(){return JSON.stringify(this.testRes,null,4)}},methods:{checkTestInput:function(){var t=this;if(""===this.offset||""===this.limit)return this.$Message.error("请填入limit和offset参数。"),!1;var a=this.testData.filter(function(t){return t.fill&&!t.check});if(a&&a.length){var e=a.map(function(t){return t.columnName}).join(",");return this.$Message.error("".concat(e,"字段为必填字段，请选中并输入数据")),!1}var i=this.testData.filter(function(t){return t.check}).filter(function(a){return!!(t.numberType.includes(a.type)&&""===a.value||"timestamp"===a.type&&""===a.value||"boolean"===a.type&&""===a.value)}).map(function(t){return t.columnName}).join(",");return!i||(this.$Message.error("".concat(i,"字段缺少过滤值内容，请输入")),!1)},stopTest:function(){var t=this;this.source.cancel(),i["stopTestApi"](c).then(function(a){t.$Message.success("停止成功")})},startTest:function(){var t=this;if(this.checkTestInput()){var a=this.detailData,e=a.tableGuid,s=a.dbGuid,l=a.maxRowNumber,r=this.testData.filter(function(t){return t.check}).map(function(t){return"timestamp"===t.type&&t.value?{columnName:t.columnName,value:[t.value.unix()]}:{columnName:t.columnName,value:[t.value]}}),o=this.detailData.fields.map(function(t){return t.columnName}),u={tableGuid:e,dbGuid:s,maxRowNumber:l,parameter:r,queryFields:o,limit:this.limit,offset:this.offset};c=Math.random().toString(36).slice(-8),this.btnLoading=!0;var d=n.a.CancelToken;this.source=d.source(),i["testApi"]({params:u,randomName:c},this.source.token).then(function(a){t.testRes=a,t.btnLoading=!1,t.$Message.success("测试完成！")}).catch(function(a){t.btnLoading=!1,console.log("Request canceled",a.message)})}}}}},"6b54":function(t,a,e){"use strict";e("3846");var i=e("cb7c"),s=e("0bfb"),n=e("9e1e"),l="toString",c=/./[l],r=function(t){e("2aba")(RegExp.prototype,l,t,!0)};e("79e5")(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?r(function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?s.call(t):void 0)}):c.name!=l&&r(function(){return c.call(this)})},"6c7b":function(t,a,e){var i=e("5ca1");i(i.P,"Array",{fill:e("36bd")}),e("9c6c")("fill")},"9c12":function(t,a,e){var i=e("d3f4"),s=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&s(t)===t}},acc6:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return!t.upperLevel||t.isHideNav?e("div",{staticClass:"content-header-single"},[t._t("header",[t._v("\n    "+t._s(t.currentLevel)+"\n  ")])],2):e("div",{staticClass:"content-header-both"},[e("div",{staticClass:"back-link"},[e("router-link",{attrs:{to:t.backPath}},[e("gs-button",{staticClass:"back-btn",attrs:{type:"primary"},on:{click:t.backBtnClick}},[e("i",{staticClass:"gs-icon gs-icon-revoke"})])],1)],1),e("div",{staticClass:"nav-name"},[e("div",{staticClass:"current-nav"},[t._v("\n      "+t._s(t.currentLevel)+"\n    ")]),e("div",{staticClass:"upper-nav"},[t._v("\n      "+t._s(t.upperLevel)+"\n    ")])])])},s=[],n={name:"BreadCrumb",props:{currentLevel:{type:String,required:!0},upperLevel:{type:String,default:""},backPath:{type:String,default:""}},data:function(){return{}},computed:{isHideNav:function(){return!!this.$router.currentRoute.query.nav}},methods:{backBtnClick:function(){this.$emit("back")}}},l=n,c=e("2877"),r=Object(c["a"])(l,i,s,!1,null,null,null),o=r.exports;e("d12e"),a["a"]=o},b1b1:function(t,a,e){var i=e("5ca1"),s=e("9c12"),n=Math.abs;i(i.S,"Number",{isSafeInteger:function(t){return s(t)&&n(t)<=9007199254740991}})},d12e:function(t,a,e){},e932:function(t,a,e){}}]);
//# sourceMappingURL=chunk-1789db4e.152f6bb1.js.map