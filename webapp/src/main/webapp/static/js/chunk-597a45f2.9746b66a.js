(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-597a45f2"],{"138d":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"data-list"},[n("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataTable",on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},"el-table",e.tableProps,!1),[e._t("default")],2),n("gs-pagination",e._b({attrs:{"page-sizes":[10,20,30,40,50,100],layout:e.paginationProps.layout||"range,total,pagesizes,pager,jumper,jumpbtn"},on:{"page-change":e.pageChange,"page-size-change":e.pageSizeChange}},"gs-pagination",e.paginationProps,!1))],1)},i=[],a={props:{tableProps:{type:Object,default:function(){return{}}},paginationProps:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},methods:{sortChange:function(e){var t=e.column,n=e.prop,o=e.order;this.$emit("sort-change",{column:t,prop:n,order:o})},handleSelectionChange:function(e){this.$emit("selection-change",e)},pageChange:function(e){this.$emit("page-change",e)},pageSizeChange:function(e){this.$emit("page-size-change",e)},clearSelection:function(){this.$refs.dataTable.clearSelection()},getTable:function(){return this.$refs.dataTable},doLayout:function(){this.$refs.dataTable.doLayout()}}},r=a,l=n("2877"),s=Object(l["a"])(r,o,i,!1,null,null,null),c=s.exports;t["a"]=c},"58c3":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"role-mangement"},[n("div",{staticClass:"search-box"},[n("add-role",{on:{refreshRoleList:e.fetchRoleList}}),n("gs-search",{attrs:{placeholder:"请输入角色名称"},on:{clear:function(t){return e.fetchRoleList(1)},search:e.fetchRoleList},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),n("data-table",{attrs:{loading:e.loading,"table-props":{data:e.tableData},"pagination-props":e.pagination},on:{"page-change":e.pageChange,"page-size-change":e.sizeChange}},[n("el-table-column",{attrs:{prop:"roleName",label:"角色名称","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"members",label:"人数"}}),n("el-table-column",{attrs:{prop:"privilegeName",label:"权限方案","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"updateTime",label:"更新时间"}}),n("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("gs-button",{attrs:{type:"text-primary"},on:{click:function(n){return e.checkDetail(t)}}},[e._v("\n          详情\n        ")]),n("gs-button",{attrs:{type:"text-primary"},on:{click:function(n){return e.openEditModal(t)}}},[e._v("\n          编辑\n        ")]),t.row.status?n("gs-button",{attrs:{disabled:!t.row.disable,type:"text-primary"},on:{click:function(n){return e.changeRoleStatus(t)}}},[e._v("\n          禁用\n        ")]):e._e(),t.row.status?e._e():n("gs-button",{attrs:{disabled:!t.row.disable,type:"text-primary"},on:{click:function(n){return e.changeRoleStatus(t)}}},[e._v("\n          启用\n        ")]),n("gs-button",{attrs:{disabled:!t.row.delete,type:"text-primary"},on:{click:function(n){return e.deleteRole(t)}}},[e._v("\n          删除\n        ")])]}}])})],1),n("edit-role",{attrs:{show:e.editModalVisible,role:e.editRoleInfo},on:{refreshRoleList:e.fetchRoleList,close:e.closeEditModal}})],1)},i=[],a=(n("e57d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("gs-button",{attrs:{type:"primary"},on:{click:e.openAddRoleModal}},[e._v("\n    新建角色\n  ")]),n("gs-modal",{attrs:{title:e.title},on:{"visible-change":e.visibleChange,confirm:e.addRole},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("gs-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[n("gs-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[n("gs-input",{model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),n("gs-form-item",{attrs:{label:"描述",prop:"description"}},[n("gs-textarea",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),n("gs-form-item",{attrs:{label:"技术方案",prop:"privilegeId"}},[n("gs-select",{staticClass:"doc-select",attrs:{searchable:"","popper-class":"searchable-select"},model:{value:e.form.privilegeId,callback:function(t){e.$set(e.form,"privilegeId",t)},expression:"form.privilegeId"}},e._l(e.privilegesOptions,function(e){return n("gs-option",{key:e.privilegeId,attrs:{label:e.privilegeName,value:e.privilegeId}})}),1)],1)],1)],1)],1)}),r=[],l=n("b369"),s={data:function(){return{visible:!1,form:{roleName:"",description:"",privilegeId:""},privilegesOptions:[],rules:{roleName:[{required:!0,message:"请填写角色名称",trigger:"blur"},{message:"角色名称长度不能超过64个字符",trigger:"blur",min:1,max:64}],description:[{message:"角色描述长度不能超过64个字符",trigger:"blur",min:1,max:64}],privilegeId:[{required:!0,message:"请选择技术方案",trigger:"change"}]}}},computed:{title:function(){return"新建角色"}},methods:{openAddRoleModal:function(){this.visible=!0},addRole:function(){var e=this;this.$refs.form.validate(function(t){t&&l["a"](e.form).then(function(t){e.visible=!1,e.$Message.success("添加成功"),e.$emit("refreshRoleList")}).catch(function(e){})})},visibleChange:function(e){var t=this;e&&(this.$refs.form.clearValidate(),l["h"]({limit:-1,query:"",offset:0}).then(function(e){t.privilegesOptions=e.lists}))}}},c=s,u=n("2877"),d=Object(u["a"])(c,a,r,!1,null,null,null),p=d.exports,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("gs-modal",{attrs:{title:e.title},on:{"visible-change":e.visibleChange,confirm:e.editRole,cancel:function(t){return e.$emit("close")}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("gs-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[n("gs-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[n("span",[e._v(e._s(e.form.roleName))])]),n("gs-form-item",{attrs:{label:"描述",prop:"description"}},[n("gs-textarea",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)],1)},g=[],m={props:{show:{type:Boolean,default:!1},role:{type:Object,default:function(){return{}}}},data:function(){return{visible:!1,form:{roleName:"",description:""}}},computed:{title:function(){return"编辑角色"}},watch:{show:function(e){this.visible=e}},methods:{editRole:function(){var e=this;this.$refs.form.validate(function(t){t&&l["f"]({roleId:e.form.roleId,params:{roleId:e.form.roleId,description:e.form.description}}).then(function(t){e.$emit("close"),e.$Message.success("编辑成功"),e.$emit("refreshRoleList")}).catch(function(e){})})},visibleChange:function(e){if(e){this.$refs.form.clearValidate();var t=this.role,n=t.roleName,o=t.description,i=t.roleId;this.form={roleName:n,description:o,roleId:i}}}}},h=m,b=Object(u["a"])(h,f,g,!1,null,null,null),v=b.exports,w=n("138d"),R={components:{addRole:p,editRole:v,dataTable:w["a"]},data:function(){return{keyword:"",tableData:[],pagination:{total:0,pageSize:10,pageSizes:[10,20,30],current:1},loading:!1,editModalVisible:!1,editRoleInfo:{}}},computed:{},created:function(){this.fetchRoleList(1)},methods:{fetchRoleList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;1===t&&(this.pagination.current=1),this.loading=!0,l["i"]({offset:(this.pagination.current-1)*this.pagination.pageSize,limit:this.pagination.pageSize,query:this.keyword}).then(function(t){t.lists.map(function(e){return e.description=e.description||"-",e.members=e.members||"0",e.privilegeName=e.privilegeName||"-",e.updateTime=e.updateTime||"-",e}),e.tableData=t.lists,e.pagination.total=t.sum||0,e.loading=!1}).catch(function(t){e.loading=!1})},pageChange:function(e){this.pagination.current=e,this.fetchRoleList()},sizeChange:function(e){this.pagination.pageSize=e,this.fetchRoleList(1)},checkDetail:function(e){var t=e.row;t.roleId&&this.$router.push("/main/auth/roleManagement/".concat(t.roleId))},deleteRole:function(e){var t=this,n=e.row;n.roleId&&this.$Modal.confirm({title:"警告",content:"是否删除该角色？删除后将无法恢复",onOk:function(){l["e"](n.roleId).then(function(e){t.$Message.success("删除角色成功"),t.fetchRoleList()})}})},changeRoleStatus:function(e){var t=this,n=e.row;this.$Modal.confirm({title:"警告",content:"确定要".concat(0===n.status?"启用":"禁用","该角色吗？"),onOk:function(){l["c"]({roleId:n.roleId,status:0===n.status?1:0}).then(function(e){t.$Message.success("".concat(0===n.status?"启用":"禁用","角色成功")),t.fetchRoleList()})}})},openEditModal:function(e){var t=e.row;this.editRoleInfo=t,this.editModalVisible=!0},closeEditModal:function(){this.editRoleInfo={},this.editModalVisible=!1}}},y=R,$=Object(u["a"])(y,o,i,!1,null,null,null);t["default"]=$.exports},b369:function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"h",function(){return r}),n.d(t,"a",function(){return l}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"j",function(){return d}),n.d(t,"b",function(){return p}),n.d(t,"c",function(){return f});var o=n("751a");function i(e){return o["a"].post("/role/roles",e)}function a(e){return o["a"].delete("/role/".concat(e))}function r(e){return o["a"].post("/role/privileges",e)}function l(e){return o["a"].post("/role",e)}function s(e){var t=e.params,n=e.roleId;return o["a"].put("/role/".concat(n),t)}function c(e,t){return o["a"].post("/role/".concat(e,"/users"),t)}function u(e,t){return o["a"].delete("/role/".concat(e,"/user"),{data:t})}function d(e){return o["a"].get("/role/".concat(e,"/privileges"))}function p(e){var t=e.params,n=e.roleId;return o["a"].put("/role/".concat(n,"/privileges"),t)}function f(e){var t=e.roleId,n=e.status;return o["a"].put("/role/".concat(t,"/").concat(n))}},e57d:function(e,t,n){}}]);
//# sourceMappingURL=chunk-597a45f2.9746b66a.js.map