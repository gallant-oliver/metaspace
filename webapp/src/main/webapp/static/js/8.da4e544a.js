webpackJsonp([8],{1160:function(e,t){},1995:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(1996),s=a(2007),n=a(378)(i.a,s.a,null,null,null);t.default=n.exports},1996:function(e,t,a){"use strict";var i=a(63),s=a.n(i),n=a(743),r=a(1997),o=a(753),l=a(754),c=a(777),d=a(1998),u=a(2001),h=a(2004),p=a(746),g=a(742),f=a(1160),v=(a.n(f),!1);t.a={name:"DataManagement",components:{ActionComfirm:o.a,DataTable:l.a,TwoColumnLayout:c.a,AddRelation:d.a,AddOwner:u.a,EditCategory:h.a,BreadCrumb:p.a},mixins:[r.a],data:function(){return{keyword:"",page:1,pageSize:10,selecteds:[],singleDeleting:null,multiDeleting:!1,tag:"",defaultExpandedKeys:[]}},computed:s()({},Object(n.c)("relation",{currentRelations:"currentRelations",searchRelations:"searchRelations",relationsStatus:"relationsStatus"}),Object(n.c)("cache",{dataRefreshStatus:"dataRefreshStatus"}),Object(n.c)("user",{modules:"modules"}),{tableData:function(){var e=this.currentRelations,t=this.searchRelations,a=this.isSearchMode,i=this.activeCategory,s=[];return s=a?t:e,i.categoryGuid||a?s:{total:0,list:[]}},tableProps:function(){var e=this.tableData;return{total:e.total,data:e.list}},paginationProps:function(){var e=this.tableProps.total||0;return{current:this.page,pageSize:this.pageSize,total:e}},isRelationLoading:function(){return Object(g.d)(this.relationsStatus)},isRefreshing:function(){return Object(g.d)(this.dataRefreshStatus)},canCreateRelation:function(){var e=this.activeCategory.privilege;return(void 0===e?{}:e).createRelation},canDeleteRelation:function(){var e=this.activeCategory.privilege;return(void 0===e?{}:e).deleteRelation},canAddOwner:function(){var e=this.modules;return e.modules&&e.modules.some(function(e){return 8===e.moduleId})}}),watch:{activeCategory:function(e){e&&(this.page=1,this.getCategoryRelation())},tableData:function(e){0===e.list.length&&0!==e.total&&(this.page=Math.ceil(e.total/this.pageSize),this.query())}},beforeRouteEnter:function(e,t,a){v=e.meta.keepAlive,a()},beforeRouteLeave:function(e,t,a){t.meta.keepAlive=!1,a()},activated:function(){!1===v&&(this.keyword="",this.tag="",this.isSearchMode=!1,this.activeCategory={},this.getTopLevelCategory())},mounted:function(){this.getTopLevelCategory()},methods:s()({},Object(n.b)("relation",["getRelations","deleteRelation","findRelations"]),Object(n.b)("cache",["refreshDataCache"]),{setActive:function(e){e&&e.categoryGuid&&(this.activeCategory=e)},refreshCache:function(){var e=this;this.refreshDataCache().then(function(){e.$Message.success("刷新缓存成功"),e.query()})},afterDeleteCategory:function(e){this.getTopLevelCategory(),this.activeCategory.categoryGuid===e&&(this.activeCategory=this.categories.list[0])},toCntAnalysis:function(){this.$router.push({path:"/main/data/analysis"})},getCategoryRelation:function(){var e=this.activeCategory;if(e.categoryGuid)return this.getRelations({categoryGuid:e.categoryGuid,param:{offset:(this.page-1)*this.pageSize,limit:this.pageSize}})},query:function(){this.isSearchMode?this.findRelations({filterTableName:this.keyword,tag:this.tag,param:{offset:(this.page-1)*this.pageSize,limit:this.pageSize}}):this.getCategoryRelation()},handlePageChange:function(e){this.page=e,this.query()},handlePageSizeChange:function(e){this.page=1,this.pageSize=e,this.query()},handleSearch:function(e){this.page=1,this.keyword=e,this.isSearchMode=!!e,this.query()},searchTable:function(){var e=this.keyword,t=this.tag;this.page=1,this.isSearchMode=!!e||!!t,this.query()},handleSelectionChange:function(e){this.selecteds=e},clearSelect:function(){this.selecteds=[],this.$refs.relationTable.clearSelection()},handleDeleteRelation:function(e){var t=this,a=this.selecteds,i=(e?e.categoryGuid:null)||this.activeCategory.categoryGuid;if(e){if(this.singleDeleting===e)return;a=[e]}var s=a.map(function(e){return{relationshipGuid:e.relationshipGuid}}),n=function(){t.singleDeleting=null,t.multiDeleting=!1};0!==s.length?(e?this.singleDeleting=e:this.multiDeleting=!0,this.deleteRelation({relations:s,categoryGuid:i}).then(function(){n(),t.selecteds=[],t.$Message.success("取消关联成功"),t.query()},n)):this.$Message.warning("请选择要取消关联的表")},jump2table:function(e){var t=this.modules;t.modules&&t.modules.some(function(e){return 7===e.moduleId})?this.$router.push({path:"/main/metadata/detail/"+e.tableGuid,query:{from:"technical"}}):this.$Message.warning("暂无查看表详情的权限，请找管理员开通")},handleNodeToggle:function(e,t){if(t)this.defaultExpandedKeys.push(e.guid);else{var a=this.defaultExpandedKeys.findIndex(function(t){return t===e.guid});-1!==a&&this.defaultExpandedKeys.splice(a,1)}}})}},1997:function(e,t,a){"use strict";var i=a(63),s=a.n(i),n=a(743),r=a(785),o=a(742),l=function(e){var t=e.privilege||{};return[{label:"在前添加同级目录",disabled:!t.addSibling,value:0},{label:"在后添加同级目录",disabled:!t.addSibling,value:1},{label:"添加子目录",disabled:!t.addChildren,value:2},{label:"编辑",disabled:!t.edit,value:3},{label:"删除",disabled:!t.delete,value:4}]};t.a={components:{SideTree:r.a},data:function(){return{isSearchMode:!1,visible:!1,actionType:-1,editingCategory:{},actions:l,activeCategory:{},disabled:!0}},computed:s()({},Object(n.c)("category",{categories:"categories"}),Object(n.c)("user",{modules:"modules"}),{isLoadingCategory:function(){return Object(o.d)(this.categories.status)},treeProps:function(){return{data:this.categories.list,expandOnFilterMatch:!0,filterNodeMethod:function(e,t){return!e||-1!==t.name.indexOf(e)},props:{label:"name",value:"categoryGuid"},disabled:!0}}}),watch:{},mounted:function(){},methods:s()({},Object(n.b)("category",["getTopLevelCategory","deleteCategory"]),{handleCategorySearch:function(e){this.$refs.sideTree.$refs.tree.filter(e)},handleSelectCategory:function(e){this.isSearchMode=!1,this.activeCategory=e},handleNodeAction:function(e,t){switch(t){case 0:this.editCategory(t,{guid:e.categoryGuid,direction:"up"});break;case 1:this.editCategory(t,{guid:e.categoryGuid,direction:"down"});break;case 2:this.editCategory(t,{guid:e.categoryGuid,parentCategoryGuid:e.categoryGuid});break;case 3:this.editCategory(t,{name:e.name,description:e.description,guid:e.categoryGuid});break;case 4:this.removeCategory(e)}},editCategory:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.actionType=e,this.visible=!0,this.editingCategory=t},removeCategory:function(e){var t=this,a=e.name,i=e.categoryGuid;this.$Modal.confirm({title:"确定要删除 "+a+" 目录吗？",onOk:function(){t.deleteCategory(i).then(function(){t.$Message.success("删除成功"),t.afterDeleteCategory&&t.afterDeleteCategory(i)})}})}})}},1998:function(e,t,a){"use strict";var i=a(1999),s=a(2e3),n=a(378)(i.a,s.a,null,null,null);t.a=n.exports},1999:function(e,t,a){"use strict";var i=a(759),s=a.n(i),n=a(760),r=a.n(n),o=a(63),l=a.n(o),c=a(743),d=a(742);t.a={props:{categoryGuid:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{visible:!1,leftSpan:{span:8,xs:{span:24}},rightSpan:{span:15,offset:1,xs:{span:24,offset:0}},keyword:"",searchType:{current:0,label:0},searchTypes:[{value:0,label:"库"},{value:1,label:"表"}],page:1,pageSize:15,selectedNodes:[]}},computed:l()({},Object(c.c)("metadata",{metadatas:"metadatas",tables:"tables"}),Object(c.c)("relation",{currentAllRelations:"currentAllRelations",relationsStatus:"relationsStatus",createStatus:"createStatus"}),{defaultChckedRelations:function(){return this.currentAllRelations.list.map(function(e){return e.tableGuid})},metadataList:function(){var e=this.metadatas.list||[],t=this.defaultChckedRelations;return e.map(function(e){var a=!0,i=e.children.map(function(e){var i=e.disabled||-1!==t.indexOf(e.value);return i||(a=!1),l()({},e,{disabled:i})});return l()({},e,{disabled:a,children:i})})},tableList:function(){var e=this.tables.list||[],t=this.defaultChckedRelations;return e.map(function(e){var a=e.disabled||-1!==t.indexOf(e.value);return l()({},e,{disabled:a})})},treeData:function(){return Object(d.d)(this.relationsStatus)?[]:0===this.searchType.current?this.metadataList:this.tableList},loading:function(){return 0===this.searchType.current?Object(d.d)(this.metadatas.status):Object(d.d)(this.tables.status)},isEmpty:function(){return 0===this.treeData.length},isCreating:function(){return Object(d.d)(this.createStatus)},selectedTables:function(){return this.selectedNodes.map(function(e){return e.data})}}),watch:{visible:function(e){this.keyword="",this.searchType={current:0,label:0},this.selectedNodes=[],e&&(this.page=1,this.getAllRelations({categoryGuid:this.categoryGuid}),this.queryMetadatas())}},methods:l()({},Object(c.b)("relation",["createRelation","getAllRelations"]),Object(c.b)("metadata",["getAllMetadataList","getTableList"]),{showModal:function(){this.visible=!0},queryMetadatas:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return r()(s.a.mark(function a(){var i,n,r,o,l,c,d,u,h;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i=e.categoryGuid,n=e.keyword,r=e.page,o=e.pageSize,l=e.metadatas,c=e.tables,d=0===e.searchType.current?l.total:c.total,!((u=(r-1)*o)>=d&&d>0)){a.next=5;break}return a.abrupt("return");case 5:if(h={categoryGuid:i,query:n,offset:u,limit:o,isSearch:t},0!==e.searchType.current){a.next=11;break}return a.next=9,e.getAllMetadataList(h);case 9:a.next=13;break;case 11:return a.next=13,e.getTableList(h);case 13:e.initSelect(e.treeData,e.defaultChckedRelations,e.selectedNodes.map(function(e){return e.data.value}));case 14:case"end":return a.stop()}},a,e)}))()},initSelect:function(e,t,a){var i=this;e.forEach(function(e){-1!==t.indexOf(e.value)&&(e.disabled=!1,i.$refs.tree.setChecked(e.value,!0),e.disabled=!0),-1!==a.indexOf(e.value)&&i.$refs.tree.setChecked(e.value,!0),e.children&&i.initSelect(e.children,t,a)})},handleSearch:function(e){this.searchType.current=this.searchType.label,this.keyword=e,this.page=1,this.queryMetadatas(!0)},handleScroll:function(e){var t=e.target,a=t.offsetHeight,i=t.scrollTop;t.scrollHeight-a-i<=20&&!this.loading&&(this.page+=1,this.queryMetadatas())},findIndex:function(e){for(var t=this.selectedTables,a=-1,i=0;i<t.length;i++)if(t[i].value===e){a=i;break}return a},handleSelectChange:function(e,t){var a=e.data,i=this.selectedNodes.map(function(e){return e.data.value});if(!t||-1===this.defaultChckedRelations.indexOf(a.value)&&-1===i.indexOf(a.value)){var s=this.findIndex(a.value);t?this.selectedNodes.push(e):this.selectedNodes.splice(s,1)}},removeTable:function(e){var t=this.findIndex(e.value),a=this.selectedNodes[t];-1!==this.$refs.tree.getCheckedKeys().indexOf(a.$node.key)?this.$refs.tree.setChecked(a.$node.key,!1):this.selectedNodes.splice(t,1)},handleConfirm:function(){var e=this,t=this.selectedTables.map(function(e){return{tableGuid:e.tableGuid,tableName:e.tableName,dbName:e.dbName,status:e.status,createTime:e.createTime}});0!==t.length?this.categoryGuid?this.createRelation({guids:t,categoryGuid:this.categoryGuid}).then(function(){e.$Message.success("添加关联成功"),e.$emit("create-success"),e.close()}):this.$Message.warning("请选择要关联的目录"):this.$Message.warning("请选择要关联的表")},close:function(){this.visible=!1}})}},2000:function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-relation-box"},[a("gs-button",{attrs:{disabled:!e.categoryGuid||e.disabled,type:"primary"},on:{click:e.showModal}},[e._v("添加关联")]),e._v(" "),a("gs-modal",{staticClass:"add-relation-modal",attrs:{width:800,title:"添加关联表"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("gs-row",[a("gs-col",e._b({staticClass:"relation-col"},"gs-col",e.leftSpan,!1),[a("label",{staticClass:"relation-label"},[e._v("待添加")]),e._v(" "),a("gs-search",{attrs:{value:e.keyword,placeholder:0===e.searchType.label?"请输入数据库":"请输入数据表"},on:{search:e.handleSearch,clear:e.handleSearch}},[a("template",{slot:"prepend"},[a("gs-select",{model:{value:e.searchType.label,callback:function(t){e.$set(e.searchType,"label",t)},expression:"searchType.label"}},e._l(e.searchTypes,function(e){return a("gs-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],2),e._v(" "),a("div",{staticClass:"database-box",on:{scroll:e.handleScroll}},[e.isEmpty?e._e():a("gs-tree",{ref:"tree",attrs:{"default-checked-keys":e.defaultChckedRelations,data:e.treeData,"node-key":"value","show-checkbox":""},on:{"current-change":e.handleSelectChange}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"database-loading"},[a("gs-icon",{attrs:{name:"loading"}}),e._v("加载中\n          ")],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isEmpty&&!e.loading,expression:"isEmpty && !loading"}],staticClass:"database-empty"},[e._v("\n            暂无数据\n          ")])],1)],1),e._v(" "),a("gs-col",e._b({staticClass:"relation-col"},"gs-col",e.rightSpan,!1),[a("label",{staticClass:"relation-label"},[e._v("已选表 ("+e._s(e.selectedTables.length)+")")]),e._v(" "),a("el-table",{attrs:{data:e.selectedTables,"max-height":"300"}},[a("el-table-column",{attrs:{prop:"label",label:"数据表"}}),e._v(" "),a("el-table-column",{attrs:{prop:"databaseName",label:"所属数据库"}}),e._v(" "),a("el-table-column",{attrs:{prop:"path",label:"路径"}}),e._v(" "),a("el-table-column",{attrs:{prop:"value",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("gs-icon",{attrs:{name:"close",mode:"button"},on:{click:function(a){return e.removeTable(t.row)}}})]}}])})],1)],1)],1),e._v(" "),a("template",{slot:"footer"},[a("gs-button",{attrs:{loading:e.isCreating,type:"primary"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("gs-button",{attrs:{disabled:e.isCreating},on:{click:e.close}},[e._v("取消")])],1)],2)],1)},staticRenderFns:[]};t.a=i},2001:function(e,t,a){"use strict";var i=a(2002),s=a(2003),n=a(378)(i.a,s.a,null,null,null);t.a=n.exports},2002:function(e,t,a){"use strict";var i=a(63),s=a.n(i),n=a(743),r=a(742),o=a(1160);a.n(o);t.a={components:{},props:{tables:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1}},data:function(){return{visible:!1,keyword:"",keymap:{label:"name",value:"realId",children:"children"},popProp:{popperClass:"owner-select-pop"},owners:[],showSelect:!1}},computed:s()({},Object(n.c)("relation",{organizations:"organizations",setOwnersStatus:"setOwnersStatus"}),{treeProp:function(){return{data:this.organizations.list||[],showTips:!0,expandOnFilterMatch:!0,filterNodeMethod:function(e,t){return!e||t.name.includes(e)}}},isCreating:function(){return Object(r.d)(this.setOwnersStatus)}}),watch:{visible:function(e){this.keyword="",this.owners=[]}},methods:s()({},Object(n.b)("relation",["getOrganization","setOwners"]),{showModal:function(){var e=this;this.tables&&this.tables.length?(this.visible=!0,this.getOrganization().then(function(t){e.showSelect=!0}).catch(function(){e.showSelect=!0})):this.$Message.warning("请选择要配置数据Owner的表")},handleConfirm:function(){var e=this,t=this.owners,a=this.tables;if(t.length){var i=a.map(function(e){return e.tableGuid}),s=t.map(function(e){return{id:parseInt(e.split("-")[0]),type:parseInt(e.split("-")[1])}});this.setOwners({tables:i,owners:s}).then(function(t){e.$Message.success("设置Owner成功"),e.$emit("create-success"),e.close()})}else this.$Message.warning("请选择Owner")},close:function(){this.visible=!1,this.showSelect=!1}})}},2003:function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-owner-box"},[a("gs-button",{attrs:{disabled:e.disabled,type:"primary"},on:{click:e.showModal}},[e._v("配置数据Owner")]),e._v(" "),a("gs-modal",{staticClass:"add-owner-modal",attrs:{width:800,top:86,title:"配置数据Owner"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticClass:"selected-table"},[a("div",{staticClass:"title-text"},[e._v("所选数据表")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tables,"max-height":"160"}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"tableName",label:"表名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"path",label:"路径"}})],1)],1),e._v(" "),a("div",{staticClass:"owners-select"},[a("div",{staticClass:"title-text"},[e._v("选择Owner")]),e._v(" "),e.showSelect?a("gs-tree-select",{attrs:{"tree-props":e.treeProp,props:e.keymap,"popover-props":e.popProp,width:"300px",placeholder:"请选择Owner"},model:{value:e.owners,callback:function(t){e.owners=t},expression:"owners"}}):e._e(),e._v(" "),e.showSelect?e._e():a("div",{staticClass:"loading-text"},[e._v("组织架构数据加载中...")]),e._v(" "),a("div",{staticClass:"tip-text"},[e._v("\n        注：数据表Owner作为数据管理员，负责审批使用该表数据的申请。\n      ")])],1),e._v(" "),a("template",{slot:"footer"},[a("gs-button",{attrs:{loading:e.isCreating,type:"primary"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("gs-button",{attrs:{disabled:e.isCreating},on:{click:e.close}},[e._v("取消")])],1)],2)],1)},staticRenderFns:[]};t.a=i},2004:function(e,t,a){"use strict";var i=a(2005),s=a(2006),n=a(378)(i.a,s.a,null,null,null);t.a=n.exports},2005:function(e,t,a){"use strict";var i=a(63),s=a.n(i),n=a(743),r=a(742);t.a={props:{isShow:{type:Boolean,default:!1},type:{type:Number,default:1},category:{type:Object,default:function(){return{}}}},data:function(){return{rules:{name:[{required:!0,max:64,message:"目录名称不能为空且不能大于64个字符"}]},visible:this.isShow,formData:this.category}},computed:s()({},Object(n.c)("category",{createStatus:"categoryCreateStatus",updateStatus:"categoryUpdateStatus"}),{loading:function(){return Object(r.d)(this.createStatus)||Object(r.d)(this.updateStatus)},title:function(){var e="";switch(this.type){case 0:e="在前添加一级目录";break;case 1:e="在后添加一级目录";break;case 2:e="添加子目录";break;case 3:e="编辑目录"}return e}}),watch:{isShow:function(e){this.visible=e},category:function(e){this.formData=e},visible:function(e){e&&this.$refs.form.resetFields(),this.$emit("update:isShow",e)}},methods:s()({},Object(n.b)("category",["createCategory","updateCategory"]),{setVisible:function(e){this.visible=e},handleOk:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a=e.type,i=e.formData,s=void 0,n="添加成功";0!==a&&1!==a&&2!==a||(s=e.createCategory(i)),3===a&&(s=e.updateCategory(i),n="修改成功"),s.then(function(){e.$Message.success(n),e.setVisible(!1),e.$emit("refresh")})}})}})}},2006:function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("gs-modal",{staticClass:"category-ceate-modal",attrs:{title:e.title},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("gs-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"70px"}},[a("gs-form-item",{attrs:{label:"目录名称",prop:"name"}},[a("gs-input",{attrs:{placeholder:"请输入目录名称，最大长度64个字符"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("gs-form-item",{attrs:{label:"描述",prop:"description"}},[a("gs-textarea",{attrs:{placeholder:"请输入描述信息，最大长度20个字符"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1)],1),e._v(" "),a("template",{slot:"footer"},[a("gs-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleOk}},[e._v("确定")]),e._v(" "),a("gs-button",{attrs:{disabled:e.loading},on:{click:function(t){return e.setVisible(!1)}}},[e._v("取消")])],1)],2)},staticRenderFns:[]};t.a=i},2007:function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-list-page"},[a("div",{staticClass:"search-group"},[a("gs-input",{staticClass:"search-name",attrs:{placeholder:"请输入表的名称"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),e._v(" "),a("gs-input",{staticClass:"search-tag",attrs:{placeholder:"请输入标签的名称"},model:{value:e.tag,callback:function(t){e.tag=t},expression:"tag"}}),e._v(" "),a("gs-button",{attrs:{type:"primary"},on:{click:e.searchTable}},[e._v("搜索")]),e._v(" "),a("div",{staticClass:"clearfix"})],1),e._v(" "),a("div",{staticClass:"content-header"},[a("bread-crumb",{attrs:{"current-level":"技术数据"}})],1),e._v(" "),a("two-column-layout",[a("side-tree",{ref:"sideTree",attrs:{slot:"left",loading:e.isLoadingCategory,active:e.activeCategory,actions:e.actions,"tree-props":e.treeProps,"default-expanded-keys":e.defaultExpandedKeys},on:{search:e.handleCategorySearch,"node-click":e.handleSelectCategory,"node-action":e.handleNodeAction,"create-category":function(t){return e.editCategory(1)},"set-active":e.setActive,"node-toggle":e.handleNodeToggle},slot:"left"}),e._v(" "),a("template",{slot:"right"},[a("h3",{staticClass:"list-title"},[e._v("\n        "+e._s(e.activeCategory.name)+"\n        "),a("gs-icon",{attrs:{title:e.isRefreshing?"正在刷新缓存...":"刷新缓存",name:e.isRefreshing?"loading":" iconfont icon-shuaxin2",disabled:e.isRefreshing,type:"primary",mode:"button"},on:{click:e.refreshCache}})],1),e._v(" "),a("div",{staticClass:"action-group"},[a("add-relation",{attrs:{"category-guid":e.activeCategory.categoryGuid,disabled:!e.canCreateRelation},on:{"create-success":e.query}}),e._v(" "),!e.isSearchMode&&e.canDeleteRelation?a("action-comfirm",{attrs:{title:"确定批量取消关联吗？"},on:{comfirm:e.handleDeleteRelation}},[a("gs-button",{staticClass:"muti-cancel",attrs:{slot:"reference",loading:e.multiDeleting,type:"primary"},slot:"reference"},[e._v("批量取消关联")])],1):e._e(),e._v(" "),e.isSearchMode||e.canDeleteRelation?e._e():a("gs-button",{staticClass:"muti-cancel",attrs:{type:"primary",disabled:""}},[e._v("批量取消关联")]),e._v(" "),a("add-owner",{attrs:{tables:e.selecteds,disabled:!e.canAddOwner},on:{"create-success":e.clearSelect}})],1),e._v(" "),a("data-table",{ref:"relationTable",attrs:{loading:e.isRelationLoading,"table-props":e.tableProps,"pagination-props":e.paginationProps},on:{"selection-change":e.handleSelectionChange,"page-change":e.handlePageChange,"page-size-change":e.handlePageSizeChange}},[a("el-table-column",{key:"selection",attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{key:"tableName",attrs:{prop:"tableName",label:"数据表"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{class:{"is-deleted":"DELETED"===t.row.status},attrs:{title:"查看表详情",href:"javascript:void(0);"},on:{click:function(a){return e.jump2table(t.row)}}},[a("gs-icon",{attrs:{name:" iconfont icon-biaoge"}}),e._v(e._s(t.row.tableName)+"\n            ")],1)]}}])}),e._v(" "),a("el-table-column",{key:"dbName",attrs:{prop:"dbName",label:"所属数据库"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("gs-icon",{attrs:{name:" iconfont icon-yuanshuju"}}),e._v(e._s(t.row.dbName)+"\n          ")]}}])}),e._v(" "),a("el-table-column",{key:"path",attrs:{prop:"path",label:"路径"}}),e._v(" "),e.isSearchMode?e._e():a("el-table-column",{key:"op",attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.canDeleteRelation?a("action-comfirm",{attrs:{title:"确定取消关联吗？"},on:{comfirm:function(a){return e.handleDeleteRelation(t.row)}}},[a("a",{attrs:{slot:"reference"},slot:"reference"},[e._v("\n                "+e._s(e.singleDeleting===t.row?"正在取消...":"取消关联")+"\n              ")])]):a("gs-button",{attrs:{type:"text-primary",disabled:""}},[e._v("取消关联")])]}}],null,!1,274532392)})],1)],1)],2),e._v(" "),a("edit-category",{attrs:{"is-show":e.visible,type:e.actionType,category:e.editingCategory},on:{"update:isShow":function(t){e.visible=t},"update:is-show":function(t){e.visible=t},refresh:e.getTopLevelCategory}})],1)},staticRenderFns:[]};t.a=i},746:function(e,t,a){"use strict";var i=a(747),s=a(750);a.n(s);t.a=i.a},747:function(e,t,a){"use strict";var i=a(748),s=a(749),n=a(378)(i.a,s.a,null,null,null);t.a=n.exports},748:function(e,t,a){"use strict";t.a={name:"BreadCrumb",props:{currentLevel:{type:String,required:!0},upperLevel:{type:String,default:""},backPath:{type:String,default:""}},data:function(){return{}},computed:{isHideNav:function(){return!!this.$router.currentRoute.query.nav}}}},749:function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return!e.upperLevel||e.isHideNav?a("div",{staticClass:"content-header-single"},[e._t("header",[e._v("\n    "+e._s(e.currentLevel)+"\n  ")])],2):a("div",{staticClass:"content-header-both"},[a("div",{staticClass:"back-link"},[a("router-link",{attrs:{to:e.backPath}},[a("gs-button",{staticClass:"back-btn",attrs:{type:"primary"}},[a("i",{staticClass:"gs-icon gs-icon-revoke"})])],1)],1),e._v(" "),a("div",{staticClass:"nav-name"},[a("div",{staticClass:"current-nav"},[e._v(e._s(e.currentLevel))]),e._v(" "),a("div",{staticClass:"upper-nav"},[e._v(e._s(e.upperLevel))])])])},staticRenderFns:[]};t.a=i},750:function(e,t){},753:function(e,t,a){"use strict";var i=a(769),s=a(772);a.n(s);t.a=i.a},754:function(e,t,a){"use strict";var i=a(766);t.a=i.a},766:function(e,t,a){"use strict";var i=a(767),s=a(768),n=a(378)(i.a,s.a,null,null,null);t.a=n.exports},767:function(e,t,a){"use strict";t.a={props:{tableProps:{type:Object,default:function(){return{}}},paginationProps:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},methods:{sortChange:function(e){var t=e.column,a=e.prop,i=e.order;this.$emit("sort-change",{column:t,prop:a,order:i})},handleSelectionChange:function(e){this.$emit("selection-change",e)},pageChange:function(e){this.$emit("page-change",e)},pageSizeChange:function(e){this.$emit("page-size-change",e)},clearSelection:function(){this.$refs.dataTable.clearSelection()},doLayout:function(){this.$refs.dataTable.doLayout()}}}},768:function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-list"},[a("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataTable",on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},"el-table",e.tableProps,!1),[e._t("default")],2),e._v(" "),a("gs-pagination",e._b({attrs:{"page-sizes":[10,20,30,40,50,100],layout:e.paginationProps.layout||"range,total,pagesizes,pager,jumper,jumpbtn"},on:{"page-change":e.pageChange,"page-size-change":e.pageSizeChange}},"gs-pagination",e.paginationProps,!1))],1)},staticRenderFns:[]};t.a=i},769:function(e,t,a){"use strict";var i=a(770),s=a(771),n=a(378)(i.a,s.a,null,null,null);t.a=n.exports},770:function(e,t,a){"use strict";t.a={props:{title:{type:String,default:""},popoverProps:{type:Object,default:function(){return{}}}},data:function(){return{visible:!1}},methods:{onComfirm:function(){this.visible=!1,this.$emit("comfirm")},onCancel:function(){this.visible=!1,this.$emit("cancel")}}}},771:function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("gs-popover",e._b({ref:"popover",staticClass:"action-comfirm-popover",attrs:{supernatant:"",placement:"top",trigger:"click"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},"gs-popover",e.popoverProps,!1),[a("div",{staticClass:"action-comfirm"},[e._t("default",[a("gs-icon",{staticClass:"action-comfirm-tip-icon",attrs:{name:"exclamation-circle"}}),e._v(e._s(e.title)+"\n    ")])],2),e._v(" "),a("div",{staticClass:"action-comfirm-footer"},[a("gs-button",{attrs:{type:"text-primary"},on:{click:e.onComfirm}},[e._v("确定")]),e._v(" "),a("gs-button",{attrs:{type:"text"},on:{click:e.onCancel}},[e._v("取消")])],1),e._v(" "),e._t("reference",null,{slot:"reference"})],2)},staticRenderFns:[]};t.a=i},772:function(e,t){},777:function(e,t,a){"use strict";var i=a(790),s=a(793);a.n(s);t.a=i.a},785:function(e,t,a){"use strict";var i=a(786),s=a(789);a.n(s);t.a=i.a},786:function(e,t,a){"use strict";var i=a(787),s=a(788),n=a(378)(i.a,s.a,null,null,null);t.a=n.exports},787:function(e,t,a){"use strict";t.a={props:{loading:{type:Boolean,default:!1},searchProps:{type:Object,default:function(){return{}}},treeProps:{type:Object,default:function(){return{}}},keyword:{type:String,default:""},actions:{type:[Array,Function],default:function(){return[]}},active:{type:Object,default:function(){return{}}},hasAction:{type:Boolean,default:!0},defaultExpanded:{type:Boolean,default:!0},defaultExpandedKeys:{type:Array,default:function(){return[]}},preicon:{type:String,default:"iconfont icon-wenjianjia1"},searchPlaceholder:{type:String,default:"请输入目录名称"},emptyBtnText:{type:String,default:"点击添加目录"}},data:function(){return{searchVal:this.keyword,expandedKeys:[]}},computed:{isEmpty:function(){return this.loading||0===this.treeProps.data.length},expand:function(){return this.defaultExpandedKeys&&this.defaultExpandedKeys.length?this.defaultExpandedKeys:this.expandedKeys}},watch:{keyword:function(e){this.searchVal=e},searchVal:function(e){this.$emit("search",e)},treeProps:function(e){e.data&&e.data.length&&this.defaultExpanded&&this.getExpandedKeys(e.data)},expandedKeys:function(e){var t=this.treeProps.data||[];if(e&&e.length){var a=t.filter(function(t){return t.guid===e[0]});if(!a||!a.length)return;if(a[0].privilege&&!a[0].privilege.ash)return void this.$emit("set-active",a[0]);var i=(a[0].children||[]).filter(function(e){return e.privilege&&!e.privilege.ash});if(!i||!i.length)return;this.$emit("set-active",i[0])}else{if(!t||!t.length)return;this.$emit("set-active",t[0])}}},methods:{getExpandedKeys:function(e){this.expandedKeys=function(e,t){var a=[];return function e(i){i.map(function(i){i.privilege&&i.privilege.ash===t&&(a.push(i.guid),i.children&&i.children&&e(i.children))})}(e),a}(e,!0)},renderTreeNode:function(e,t){t.node;var a,i=t.data,s=this.actions,n=this.treeProps,r=this.active,o=this.hasAction,l=n.props,c=l.label,d=l.value,u=l.deleting,h=void 0===u?"deleting":u,p="side-tree-node-label";return"function"==typeof s&&(s=s(i)),p+=r[d]===i[d]?" is-active":"",p+=i.disabled?" is-disabled":"",p+=i[h]?" is-deleting":"",e("div",{class:"side-tree-node-content"},[i[h]?e("span",{class:p},[e("gs-icon",{class:"side-tree-node-icon",attrs:{title:"正在删除",name:"loading"}}),i[c]]):e("span",{attrs:{title:i[c]},class:p,on:{click:this.handleClick.bind(this,i)}},[e("i",(a={class:"side-tree-node-icon"},a.class=this.preicon,a)),i[c]]),o?e("gs-dropdown",{class:"side-tree-action",attrs:{trigger:"click"},on:{select:this.handleAction.bind(this,i)}},[e("gs-icon",{class:"gs-dropdown-link",attrs:{name:"ellipsis",mode:"button"}}),e("gs-dropdown-menu",{attrs:{align:"right"},slot:"dropdown"},[e("gs-dropdown-items",{attrs:{options:s}})])]):null])},handleNodeToggle:function(e,t){this.$emit("node-toggle",e.data,t)},handleClick:function(e){e.disabled||this.$emit("node-click",e)},handleAction:function(e,t){this.$emit("node-action",e,t)},createCategory:function(){this.$emit("create-category")}}}},788:function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"side-tree"},[e.isEmpty?e._e():a("gs-search",e._b({ref:"search",attrs:{placeholder:e.searchPlaceholder},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}},"gs-search",e.searchProps,!1)),e._v(" "),e.isEmpty?e._e():a("gs-tree",e._b({ref:"tree",attrs:{"render-content":e.renderTreeNode,"default-expanded-keys":e.expand,"node-key":"guid"},on:{"node-toggle":e.handleNodeToggle}},"gs-tree",e.treeProps,!1)),e._v(" "),!e.loading&&e.isEmpty&&e.hasAction?a("gs-button",{attrs:{disabled:e.treeProps.disabled,type:"primary"},on:{click:e.createCategory}},[e._v(e._s(e.emptyBtnText))]):e._e()],1)},staticRenderFns:[]};t.a=i},789:function(e,t){},790:function(e,t,a){"use strict";var i=a(791),s=a(792),n=a(378)(i.a,s.a,null,null,null);t.a=n.exports},791:function(e,t,a){"use strict";t.a={props:{leftProps:{type:Object,default:function(){return{span:6,xs:{span:24}}}},rightProps:{type:Object,default:function(){return{span:18,xs:{span:24}}}}}}},792:function(e,t,a){"use strict";var i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"two-column-layout"},[t("div",{staticClass:"left-col"},[this._t("left")],2),this._v(" "),t("div",{staticClass:"right-col"},[this._t("right")],2)])},staticRenderFns:[]};t.a=i},793:function(e,t){}});
//# sourceMappingURL=8.da4e544a.js.map