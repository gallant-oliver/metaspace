webpackJsonp([19],{2114:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2115),o=i(2120),a=i(107)(n.a,o.a,null,null,null);t.default=a.exports},2115:function(e,t,i){"use strict";var n=i(2116),o=(i.n(n),i(917)),a=i(2117),s=i(774);t.a={components:{addAuth:a.a,dataTable:s.a},data:function(){return{keyword:"",tableData:[{userId:"1",username:"1",account:"in",roles:["amet irure","222"]}],pagination:{total:0,pageSize:10,pageSizes:[10,20,30],current:1},loading:!1,editPrivilegeId:"",editModalVisible:!1}},computed:{},created:function(){this.fetchAuthList(1)},methods:{fetchAuthList:function(){var e=this;1===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)&&(this.pagination.current=1),this.loading=!0,o.f({offset:(this.pagination.current-1)*this.pagination.pageSize,limit:this.pagination.pageSize,query:this.keyword}).then(function(t){t.lists.map(function(e){return e.role=e.roles.map(function(e){return e.roleName}),e}),e.tableData=t.lists,e.pagination.total=t.sum,e.loading=!1}).catch(function(t){e.loading=!1})},pageChange:function(e){this.pagination.current=e,this.fetchAuthList()},sizeChange:function(e){this.pagination.pageSize=e,this.fetchAuthList(1)},addPrivilege:function(e){var t=this;o.a(e).then(function(e){t.fetchAuthList(1),t.$Message.success("添加方案成功！"),t.editModalVisible=!1})},editPrivilege:function(e){var t=this,i=e.id,n=e.params;o.c(i,n).then(function(e){t.fetchAuthList(),t.$Message.success("修改方案成功！"),t.editModalVisible=!1})},openEditAuthModal:function(e){var t=e.row;this.editPrivilegeId=t.privilegeId,this.editModalVisible=!0},deleteAuth:function(e){var t=this,i=e.row;i.privilegeId&&(!i.roles||i.roles&&!i.roles.length)?this.$Modal.confirm({title:"警告",content:"是否删除该权限方案？删除后将无法恢复",onOk:function(){o.b(i.privilegeId).then(function(e){t.$Message.success("删除权限方案成功"),t.fetchAuthList()})}}):this.$Message.warning("请先全清空使用该权限方案的角色！")},openAddAuthModal:function(){this.editPrivilegeId="",this.editModalVisible=!0}}}},2116:function(e,t){},2117:function(e,t,i){"use strict";var n=i(2118),o=i(2119),a=i(107)(n.a,o.a,null,null,null);t.a=a.exports},2118:function(e,t,i){"use strict";var n=i(389),o=i.n(n),a=i(108),s=i.n(a),r=i(385),l=i.n(r),u=i(917),c=i(781),d=c.a.techData,f=c.a.businessObject,p=c.a.manageTechCagatory,g=c.a.editTechInfo,m=c.a.manageBusinessCagatory,h=c.a.editBusinessInfo;t.a={props:{privilegeId:{type:String,default:""},value:{type:Boolean,default:!1}},data:function(){return{roleOptions:[],form:{modules:[],description:"",privilegeName:"",roles:[]},loading:!1,rules:{privilegeName:[{required:!0,max:64,message:"方案名称不能为空且不能大于64个字符"}]},opeModules:[],authModules:[]}},computed:{visible:{get:function(){return this.value},set:function(e){return e}},title:function(){return this.privilegeId?"编辑方案":"添加方案"}},methods:{confirm:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.privilegeId?e.$emit("editPrivilege",{id:e.privilegeId,params:e.form}):e.$emit("addPrivilege",e.form))})},visibleChange:function(e){var t=this;if(e){this.loading=!0,this.$refs.form.clearValidate();this.form={modules:[],description:"",privilegeName:"",roles:[]},l.a.all([u.d().then(function(e){t.opeModules=e.filter(function(e){return 0===e.type}),t.authModules=e.filter(function(e){return 1===e.type})}),u.g({limit:-1,query:""}).then(function(e){t.roleOptions=e.lists})]).then(function(e){t.privilegeId?t.getPrivilegeDetail().then(function(e){t.loading=!1}):t.loading=!1})}},getPrivilegeDetail:function(){var e=this;return u.e(this.privilegeId).then(function(t){var i=t.description,n=t.privilegeName,o=t.modules,a=t.roles;e.form={description:i,privilegeName:n,modules:o.map(function(e){return e.moduleId}),roles:a.map(function(e){return e.roleId})}})},opeModuleCheckboxChange:function(e){Array.isArray(e)&&(this.form.modules=e.includes(g)?s()(new o.a([d,g].concat(this.form.modules))):this.form.modules,this.form.modules=e.includes(p)?s()(new o.a([d,p].concat(this.form.modules))):this.form.modules,this.form.modules=e.includes(h)?s()(new o.a([f,h].concat(this.form.modules))):this.form.modules,this.form.modules=e.includes(m)?s()(new o.a([f,m].concat(this.form.modules))):this.form.modules)},authModuleCheckboxChange:function(e){if(!e.includes(d)){var t=this.form.modules.findIndex(function(e){return e===g});-1!==t&&this.form.modules.splice(t,1);var i=this.form.modules.findIndex(function(e){return e===p});-1!==i&&this.form.modules.splice(i,1)}if(!e.includes(2)){var n=this.form.modules.findIndex(function(e){return e===h});-1!==n&&this.form.modules.splice(n,1);var o=this.form.modules.findIndex(function(e){return e===m});-1!==o&&this.form.modules.splice(o,1)}}}}},2119:function(e,t,i){"use strict";var n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gs-modal",{staticClass:"add-auth",attrs:{title:e.title,top:"60px"},on:{cancel:function(t){return e.$emit("input",!1)},confirm:e.confirm,"visible-change":e.visibleChange},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("gs-loading",{attrs:{"is-show":e.loading}}),e._v(" "),i("gs-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[i("gs-form-item",{attrs:{label:"方案名称",prop:"privilegeName"}},[i("gs-input",{model:{value:e.form.privilegeName,callback:function(t){e.$set(e.form,"privilegeName",t)},expression:"form.privilegeName"}})],1),e._v(" "),i("gs-form-item",{attrs:{label:"描述",prop:"description"}},[i("gs-textarea",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),i("gs-form-item",{attrs:{label:"授权内容",prop:"module"}},[i("div",{staticClass:"modules"},[i("div",{staticClass:"module"},[i("label",{staticClass:"title"},[e._v("授权模块")]),e._v(" "),i("gs-checkbox-group",{on:{change:e.authModuleCheckboxChange},model:{value:e.form.modules,callback:function(t){e.$set(e.form,"modules",t)},expression:"form.modules"}},e._l(e.authModules,function(t){return i("gs-checkbox",{key:t.moduleId,attrs:{label:t.moduleId}},[e._v(e._s(t.moduleName))])}),1)],1),e._v(" "),i("div",{staticClass:"bussiness-obj-ope"},[i("label",{staticClass:"title"},[e._v("管理权限")]),e._v(" "),i("gs-checkbox-group",{on:{change:e.opeModuleCheckboxChange},model:{value:e.form.modules,callback:function(t){e.$set(e.form,"modules",t)},expression:"form.modules"}},e._l(e.opeModules,function(t){return i("gs-checkbox",{key:t.moduleId,attrs:{label:t.moduleId}},[e._v(e._s(t.moduleName))])}),1)],1)])]),e._v(" "),i("gs-form-item",{attrs:{label:"授权角色",prop:"roles"}},[i("gs-select",{attrs:{multiple:""},model:{value:e.form.roles,callback:function(t){e.$set(e.form,"roles",t)},expression:"form.roles"}},e._l(e.roleOptions,function(e){return i("gs-option",{key:e.roleId,attrs:{label:e.roleName,title:e.roleName,value:e.roleId}})}),1)],1)],1)],1)},staticRenderFns:[]};t.a=n},2120:function(e,t,i){"use strict";var n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"auth-mangement"},[i("div",{staticClass:"search-box"},[i("gs-button",{attrs:{type:"primary"},on:{click:e.openAddAuthModal}},[e._v("添加方案")]),e._v(" "),i("gs-search",{attrs:{placeholder:"请输入方案名称"},on:{clear:function(t){return e.fetchAuthList(1)},search:e.fetchAuthList},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),i("data-table",{attrs:{loading:e.loading,"table-props":{data:e.tableData},"pagination-props":e.pagination},on:{"page-change":e.pageChange,"page-size-change":e.sizeChange}},[i("el-table-column",{attrs:{prop:"privilegeName",label:"方案名称"}}),e._v(" "),i("el-table-column",{attrs:{prop:"description",label:"描述"}}),e._v(" "),i("el-table-column",{attrs:{prop:"roles",label:"授权角色"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.role||[],function(t){return i("gs-tag",{key:t},[e._v("\n          "+e._s(t)+"\n        ")])})}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("gs-button",{attrs:{disabled:!t.row.edit,type:"text-primary"},on:{click:function(i){return e.openEditAuthModal(t)}}},[e._v("编辑")]),e._v(" "),i("gs-button",{attrs:{disabled:!t.row.delete,type:"text-primary"},on:{click:function(i){return e.deleteAuth(t)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("add-auth",{attrs:{"privilege-id":e.editPrivilegeId},on:{addPrivilege:e.addPrivilege,editPrivilege:e.editPrivilege},model:{value:e.editModalVisible,callback:function(t){e.editModalVisible=t},expression:"editModalVisible"}})],1)},staticRenderFns:[]};t.a=n},774:function(e,t,i){"use strict";var n=i(782);t.a=n.a},782:function(e,t,i){"use strict";var n=i(783),o=i(784),a=i(107)(n.a,o.a,null,null,null);t.a=a.exports},783:function(e,t,i){"use strict";t.a={props:{tableProps:{type:Object,default:function(){return{}}},paginationProps:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},methods:{sortChange:function(e){var t=e.column,i=e.prop,n=e.order;this.$emit("sort-change",{column:t,prop:i,order:n})},handleSelectionChange:function(e){this.$emit("selection-change",e)},pageChange:function(e){this.$emit("page-change",e)},pageSizeChange:function(e){this.$emit("page-size-change",e)},clearSelection:function(){this.$refs.dataTable.clearSelection()},getTable:function(){return this.$refs.dataTable},doLayout:function(){this.$refs.dataTable.doLayout()}}}},784:function(e,t,i){"use strict";var n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"data-list"},[i("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataTable",on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},"el-table",e.tableProps,!1),[e._t("default")],2),e._v(" "),i("gs-pagination",e._b({attrs:{"page-sizes":[10,20,30,40,50,100],layout:e.paginationProps.layout||"range,total,pagesizes,pager,jumper,jumpbtn"},on:{"page-change":e.pageChange,"page-size-change":e.pageSizeChange}},"gs-pagination",e.paginationProps,!1))],1)},staticRenderFns:[]};t.a=n},917:function(e,t,i){"use strict";t.f=function(e){return n.a.post("/privilege/privileges",e)},t.b=function(e){return n.a.delete("/privilege/"+e)},t.e=function(e){return n.a.get("/privilege/"+e)},t.d=function(){return n.a.get("/privilege/modules")},t.a=function(e){return n.a.post("/privilege",e)},t.c=function(e,t){return n.a.put("/privilege/"+e,t)},t.g=function(e){return n.a.post("/privilege/roles",e)};var n=i(773)}});
//# sourceMappingURL=19.6bd9374d.js.map